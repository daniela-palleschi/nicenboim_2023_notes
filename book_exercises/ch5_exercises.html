<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniela Palleschi">

<title>Daniela’s Notes for Nicemboim, Schad, &amp; Vasishth (2024) - 6&nbsp; Ch. Exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../book_exercises/ch8_exercises.html" rel="next">
<link href="../book_exercises/ch1_exercises.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: {autoNumber: "AMS"} },
  tex2jax: {inlineMath: [ ['$','$'], ["\\(","\\)"] ]}
});
</script>

<!-- This is what works with Quarto -->
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="cutsom.css">
<meta name="twitter:title" content="Daniela’s Notes for Nicemboim, Schad, &amp; Vasishth (2024) - 6&nbsp; Ch. Exercises">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Daniela’s Notes for Nicemboim, Schad, &amp; Vasishth (2024)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Suchen"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Navigation umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://daniela-palleschi.github.io/"> <i class="bi bi-home" role="img">
</i> 
<span class="menu-text">D. Palleschi</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Dunkelmodus umschalten"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book_exercises/ch1_exercises.html">Book exercises</a></li><li class="breadcrumb-item"><a href="../book_exercises/ch5_exercises.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ch. Exercises</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Purpose</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../setup/project_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project set-up</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Book notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_notes/ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Chapter notes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_notes/ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Ch. 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_notes/ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ch. 3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_notes/ch8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Contrast Coding</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Book exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_exercises/ch1_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ch. 1 Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_exercises/ch5_exercises.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ch. Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book_exercises/ch8_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Ch. 8 Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literaturverzeichnis</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Chatper contents</h2>
   
  <ul>
  <li><a href="#set-options" id="toc-set-options" class="nav-link active" data-scroll-target="#set-options">Set options</a></li>
  <li><a href="#chapter-5---bayesian-hierachical-models" id="toc-chapter-5---bayesian-hierachical-models" class="nav-link" data-scroll-target="#chapter-5---bayesian-hierachical-models"><span class="header-section-number">7</span> Chapter 5 - Bayesian hierachical models</a>
  <ul>
  <li><a href="#exercise-5.1-a-hierarchical-model-normal-likelihood-of-cognitive-load-on-pupil-." id="toc-exercise-5.1-a-hierarchical-model-normal-likelihood-of-cognitive-load-on-pupil-." class="nav-link" data-scroll-target="#exercise-5.1-a-hierarchical-model-normal-likelihood-of-cognitive-load-on-pupil-."><span class="header-section-number">7.1</span> Exercise 5.1 A hierarchical model (normal likelihood) of cognitive load on pupil .</a></li>
  <li><a href="#exercise-5.2-are-subject-relatives-easier-to-process-than-object-relatives-log-normal-likelihood" id="toc-exercise-5.2-are-subject-relatives-easier-to-process-than-object-relatives-log-normal-likelihood" class="nav-link" data-scroll-target="#exercise-5.2-are-subject-relatives-easier-to-process-than-object-relatives-log-normal-likelihood"><span class="header-section-number">7.2</span> Exercise 5.2 Are subject relatives easier to process than object relatives (log-normal likelihood)?</a></li>
  <li><a href="#exercise-5.3-relative-clause-processing-in-mandarin-chinese" id="toc-exercise-5.3-relative-clause-processing-in-mandarin-chinese" class="nav-link" data-scroll-target="#exercise-5.3-relative-clause-processing-in-mandarin-chinese"><span class="header-section-number">7.3</span> Exercise 5.3 Relative clause processing in Mandarin Chinese</a></li>
  <li><a href="#exercise-5.4---agreement-attraction-in-comprehension" id="toc-exercise-5.4---agreement-attraction-in-comprehension" class="nav-link" data-scroll-target="#exercise-5.4---agreement-attraction-in-comprehension"><span class="header-section-number">7.4</span> Exercise 5.4 - Agreement attraction in comprehension</a></li>
  <li><a href="#exercise-5.5" id="toc-exercise-5.5" class="nav-link" data-scroll-target="#exercise-5.5"><span class="header-section-number">7.5</span> Exercise 5.5</a></li>
  <li><a href="#exercise-5.6" id="toc-exercise-5.6" class="nav-link" data-scroll-target="#exercise-5.6"><span class="header-section-number">7.6</span> Exercise 5.6</a></li>
  <li><a href="#exercise-5.7" id="toc-exercise-5.7" class="nav-link" data-scroll-target="#exercise-5.7"><span class="header-section-number">7.7</span> Exercise 5.7</a></li>
  <li><a href="#exercise-5.8" id="toc-exercise-5.8" class="nav-link" data-scroll-target="#exercise-5.8"><span class="header-section-number">7.8</span> Exercise 5.8</a></li>
  </ul></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">8</span> Session Info</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book_exercises/ch1_exercises.html">Book exercises</a></li><li class="breadcrumb-item"><a href="../book_exercises/ch5_exercises.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ch. Exercises</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ch. Exercises</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Autor:in</div>
    <div class="quarto-title-meta-contents">
             <p>Daniela Palleschi </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="set-options" class="level1 unnumbered">
<h1 class="unnumbered">Set options</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set global knit options</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::opts_chunk$set(echo = T,</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                       eval = T,</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                       error = F,</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                       warning = F,</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                       message = F,</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                       cache = T)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># suppress scientific notation</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># list of required packages</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="co">#"SIN", # this package was removed from the CRAN repository</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">"MASS"</span>, <span class="st">"dplyr"</span>, <span class="st">"tidyr"</span>, <span class="st">"purrr"</span>, <span class="st">"extraDistr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"loo"</span>, <span class="st">"bridgesampling"</span>, <span class="st">"brms"</span>, <span class="st">"bayesplot"</span>, <span class="st">"tictoc"</span>, <span class="st">"hypr"</span>, <span class="st">"bcogsci"</span>, <span class="st">"papaja"</span>, <span class="st">"grid"</span>, <span class="st">"kableExtra"</span>, <span class="st">"gridExtra"</span>, <span class="st">"lme4"</span>, <span class="st">"cowplot"</span>, <span class="st">"pdftools"</span>, <span class="st">"cmdstanr"</span>, <span class="st">"rootSolve"</span>, <span class="st">"rstan"</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># NB: if you haven't already installed bcogsci through devtools, it won't be loaded</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Now load or install &amp; load all</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>package.check <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  packages,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">install.packages</span>(x, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">library</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># this is also required, taken from the textbook</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Save compiled models:</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Parallelize the chains using all the cores:</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co"># To solve some conflicts between packages</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>select <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>select</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>extract <span class="ot">&lt;-</span> rstan<span class="sc">::</span>extract</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="chapter-5---bayesian-hierachical-models" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Chapter 5 - Bayesian hierachical models</h1>
<section id="exercise-5.1-a-hierarchical-model-normal-likelihood-of-cognitive-load-on-pupil-." class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="exercise-5.1-a-hierarchical-model-normal-likelihood-of-cognitive-load-on-pupil-."><span class="header-section-number">7.1</span> Exercise 5.1 A hierarchical model (normal likelihood) of cognitive load on pupil .</h2>
<p>As in section 4.1, we focus on the effect of cognitive load on pupil , but this time we look at all the subjects of Wahn et al.&nbsp;(2016):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_pupil_complete"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df_pupil_complete</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,228 × 4
    subj trial  load p_size
   &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
 1   701     1     2  1021.
 2   701     2     1   951.
 3   701     3     5  1064.
 4   701     4     4   913.
 5   701     5     0   603.
 6   701     6     3   826.
 7   701     7     0   464.
 8   701     8     4   758.
 9   701     9     2   733.
10   701    10     3   591.
# ℹ 2,218 more rows</code></pre>
</div>
</div>
<p>You should be able to now fit a “maximal” model (correlated varying intercept and slopes for subjects) assuming a normal likelihood. Base your priors in the priors discussed in section 4.1.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Maximal model
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>first centre the predictor</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_pupil_complete <span class="ot">&lt;-</span> df_pupil_complete <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c_load =</span> load<span class="sc">-</span><span class="fu">mean</span>(load))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>then run the model</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fit_pupil <span class="ot">&lt;-</span> <span class="fu">brm</span>(p_size <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> c_load <span class="sc">+</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span>c_load <span class="sc">|</span> subj), </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_pupil_complete,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1000</span>, <span class="dv">500</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1000</span>), <span class="at">class =</span> sigma),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">class =</span> b, <span class="at">coef =</span> c_load),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1000</span>), <span class="at">class =</span> sd),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                 ),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_pupil"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ol type="a">
<li>Examine the effect of load on pupil size, and the average pupil size. What do you conclude?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
My solution
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fit_pupil</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: p_size ~ 1 + c_load + (1 + c_load | subj) 
   Data: df_pupil_complete (Number of observations: 2228) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~subj (Number of levels: 20) 
                      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)          3307.53    441.75  2508.84  4235.77 1.01      646
sd(c_load)               70.18     14.34    46.89   102.39 1.00     1269
cor(Intercept,c_load)     0.30      0.23    -0.18     0.69 1.00     1327
                      Tail_ESS
sd(Intercept)              658
sd(c_load)                2262
cor(Intercept,c_load)     1906

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept  2509.25    490.72  1527.81  3439.77 1.00      488      737
c_load       40.46     22.95    -6.86    84.83 1.00     1260     1734

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma   505.27      7.61   490.27   520.55 1.00     5434     2639

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<ul>
<li><p>95% CrI crosses 0: quite a bit of uncertainty</p></li>
<li><p>alternatively, to only print <code>c_load</code></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_pupil, <span class="at">variable =</span> <span class="st">"b_c_load"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Estimate Est.Error      Q2.5    Q97.5
b_c_load 40.46367  22.94823 -6.863523 84.82657</code></pre>
</div>
</div>
<ul>
<li>but the intercept is quite large:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_pupil, <span class="at">variable =</span> <span class="st">"b_Intercept"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Est.Error     Q2.5    Q97.5
b_Intercept 2509.251  490.7152 1527.807 3439.766</code></pre>
</div>
</div>
<ul>
<li>even though we assumed it wouldn’t be</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">prior_summary</span>(fit_pupil)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                prior     class      coef group resp dpar nlpar lb ub
               (flat)         b                                      
       normal(0, 100)         b    c_load                            
    normal(1000, 500) Intercept                                      
 lkj_corr_cholesky(2)         L                                      
 lkj_corr_cholesky(2)         L            subj                      
      normal(0, 1000)        sd                                  0   
      normal(0, 1000)        sd            subj                  0   
      normal(0, 1000)        sd    c_load  subj                  0   
      normal(0, 1000)        sd Intercept  subj                  0   
      normal(0, 1000)     sigma                                  0   
       source
      default
         user
         user
         user
 (vectorized)
         user
 (vectorized)
 (vectorized)
 (vectorized)
         user</code></pre>
</div>
</div>
<ul>
<li>overly informative prior for the intercept?</li>
</ul>
</div>
</div>
<ol start="2" type="a">
<li>Do a sensitivity analysis for the prior on the intercept (<span class="math inline">\(\alpha\)</span>). What is the estimate of the effect (<span class="math inline">\(\beta\)</span>) under different priors?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
My solution
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>try a <em>wider</em> prior for <span class="math inline">\(\alpha\)</span>; I’m choosing 3000 and 1000ms</li>
</ul>
<p><span class="math display">\[
\alpha \sim Normal(3000,1000)
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fit_pupil_2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(p_size <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> c_load <span class="sc">+</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span> c_load <span class="sc">|</span> subj), </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_pupil_complete,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">3000</span>, <span class="dv">1000</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1000</span>), <span class="at">class =</span> sigma),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">class =</span> b, <span class="at">coef =</span> c_load),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1000</span>), <span class="at">class =</span> sd),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                 ),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_pupil_2"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_pupil_2, <span class="at">variable =</span> <span class="st">"b_c_load"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Estimate Est.Error     Q2.5    Q97.5
b_c_load 56.46641  17.02009 22.75433 90.09126</code></pre>
</div>
</div>
<ul>
<li>the effect of <code>c_load</code> now ha more certainty</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_pupil, <span class="at">variable =</span> <span class="st">"b_Intercept"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Est.Error     Q2.5    Q97.5
b_Intercept 2509.251  490.7152 1527.807 3439.766</code></pre>
</div>
</div>
</div>
</div>
<ol start="3" type="a">
<li>Is the effect of load consistent across subjects? Investigate this visually.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
My solution
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>check out overall effect; there are 3 peaks</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit_pupil_2, <span class="at">ndraws =</span> <span class="dv">50</span>, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>now by participants</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay_grouped</span>(df_pupil_complete<span class="sc">$</span>p_size,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrep =</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">posterior_predict</span>(fit_pupil_2,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ndraws =</span> <span class="dv">100</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> df_pupil_complete<span class="sc">$</span>subj</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Signal in the N400 spatiotemporal window"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>and by sd</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit_pupil_2,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"stat_grouped"</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">1000</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"subj"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">stat =</span> <span class="st">"sd"</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>and also:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For the hierarchical model is more complicated, # because we want the effect (beta) + adjustment: # we extract the overall group level effect:</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as_draws_df</span>(fit_pupil_2)<span class="sc">$</span>b_c_load)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We extract the individual adjustments</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ind_effects_v <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"r_subj["</span>, <span class="fu">unique</span>(df_pupil_complete<span class="sc">$</span>subj), <span class="st">",c_load]"</span>) </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>adjustment <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_draws_df</span>(fit_pupil)[ind_effects_v])</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We get the by subject effects in a data frame where each adjustment # is in each column.</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>by_subj_effect <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(beta <span class="sc">+</span> adjustment)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We summarize them by getting a table with the mean and the</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles for each column and then binding them.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>par_h <span class="ot">&lt;-</span> <span class="fu">lapply</span>(by_subj_effect, <span class="cf">function</span>(x) {</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> <span class="fu">mean</span>(x),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q2.5 =</span> <span class="fu">quantile</span>(x, .<span class="dv">025</span>),</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q97.5 =</span> <span class="fu">quantile</span>(x, .<span class="dv">975</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We add a column to identify that the model, # and one with the subject labels:</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subj =</span> <span class="fu">unique</span>(df_pupil_complete<span class="sc">$</span>subj)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Estimate) <span class="sc">%&gt;%</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subj =</span> <span class="fu">factor</span>(subj, <span class="at">levels =</span> subj))</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(par_h,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymin =</span> Q2<span class="fl">.5</span>,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymax =</span> Q97<span class="fl">.5</span>,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> subj,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> Estimate</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>() <span class="sc">+</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We'll also add the mean and 95% CrI of the overall difference # to the plot:</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>               <span class="fu">posterior_summary</span>(fit_pupil_2)[<span class="st">"b_c_load"</span>, <span class="st">"Estimate"</span>]) <span class="sc">+</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">posterior_summary</span>(fit_pupil_2)[<span class="st">"b_c_load"</span>, <span class="st">"Q2.5"</span>],</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> .<span class="dv">5</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">geom_hline</span>(</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">posterior_summary</span>(fit_pupil_2)[<span class="st">"b_c_load"</span>, <span class="st">"Q97.5"</span>],</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> .<span class="dv">5</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Change in pupil size"</span>) <span class="sc">+</span> </span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Participant ID"</span>) <span class="sc">+</span></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="exercise-5.2-are-subject-relatives-easier-to-process-than-object-relatives-log-normal-likelihood" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="exercise-5.2-are-subject-relatives-easier-to-process-than-object-relatives-log-normal-likelihood"><span class="header-section-number">7.2</span> Exercise 5.2 Are subject relatives easier to process than object relatives (log-normal likelihood)?</h2>
<p>We begin with a classic question from the psycholinguistics literature: Are subject relatives easier to process than object relatives? The data come from Experiment 1 in a paper by Grodner and Gibson (2005).</p>
<p>Scientific question: Is there a subject relative advantage in reading?</p>
<p>Grodner and Gibson (2005) investigate an old claim in psycholinguistics that object relative clause (ORC) sentences are more difficult to process than subject relative clause (SRC) sentences. One explanation for this predicted difference is that the distance between the relative clause verb (sent in the example below) and the head noun phrase of the relative clause (reporter in the example below) is longer in ORC vs.&nbsp;SRC. Examples are shown below. The relative clause is shown in square brackets.</p>
<p>(1a) The reporter [who the photographer sent to the editor] was hoping for a good story. (ORC)</p>
<p>(1b) The reporter [who sent the photographer to the editor] was hoping for a good story. (SRC)</p>
<p>The underlying explanation has to do with memory processes: Shorter linguistic dependencies are easier to process due to either reduced interference or decay, or both. For implemented computational models that spell this point out, see Lewis and Vasishth (2005) and Engelmann, Jäger, and Vasishth (2020).</p>
<p>In the Grodner and Gibson data, the dependent measure is reading time at the relative clause verb, (e.g., sent) of different sentences with either ORC or SRC. The dependent variable is in milliseconds and was measured in a self-paced reading task. Self-paced reading is a task where subjects read a sentence or a short text word-by-word or phrase-by-phrase, pressing a button to get each word or phrase displayed; the preceding word disappears every time the button is pressed. In 6.1, we provide a more detailed explanation of this experimental method.</p>
<p>For this experiment, we are expecting longer reading times at the relative clause verbs of ORC sentences in comparison to the relative clause verb of SRC sentences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_gg05_rc"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df_gg05_rc</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 672 × 7
    subj  item condition    RT residRT qcorrect experiment
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt; &lt;chr&gt;     
 1     1     1 objgap      320  -21.4         0 tedrg3    
 2     1     2 subjgap     424   74.7         1 tedrg2    
 3     1     3 objgap      309  -40.3         0 tedrg3    
 4     1     4 subjgap     274  -91.2         1 tedrg2    
 5     1     5 objgap      333   -8.39        1 tedrg3    
 6     1     6 subjgap     266  -87.3         1 tedrg2    
 7     1     7 objgap      327  -42.2         1 tedrg3    
 8     1     8 subjgap     279  -90.2         1 tedrg2    
 9     1     9 objgap      342  -23.2         1 tedrg3    
10     1    10 subjgap     297  -52.3         0 tedrg2    
# ℹ 662 more rows</code></pre>
</div>
</div>
<p>You should use a sum coding for the predictors. Here, object relative clauses (“objgaps”) are coded +1, subject relative clauses -1.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Set contrasts
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df_gg05_rc<span class="sc">$</span>condition <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_gg05_rc<span class="sc">$</span>condition, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"subjgap"</span>,<span class="st">"objgap"</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df_gg05_rc<span class="sc">$</span>condition)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gg05_rc<span class="sc">$</span>condition) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">5</span>,<span class="sc">+</span>.<span class="dv">5</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gg05_rc<span class="sc">$</span>condition)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]
subjgap -0.5
objgap   0.5</code></pre>
</div>
</div>
<ul>
<li>or, as in the book:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df_gg05_rc <span class="ot">&lt;-</span> df_gg05_rc <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c_cond =</span> <span class="fu">if_else</span>(condition <span class="sc">==</span> <span class="st">"objgap"</span>, .<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>You should be able to now fit a “maximal” model (correlated varying intercept and slopes for subjects and for items) assuming a log-normal likelihood.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Maximal model
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fit_df_gg05_rc <span class="ot">&lt;-</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    RT <span class="sc">~</span> condition <span class="sc">+</span> (condition <span class="sc">|</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                     subj) <span class="sc">+</span> (condition <span class="sc">|</span> item),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">6</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, .<span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_gg05_rc,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_df_gg05_rc"</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>fit_df_gg05_rc</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: lognormal 
  Links: mu = identity; sigma = identity 
Formula: RT ~ condition + (condition | subj) + (condition | item) 
   Data: df_gg05_rc (Number of observations: 672) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~item (Number of levels: 16) 
                          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                 0.04      0.02     0.00     0.09 1.00     1175
sd(condition1)                0.09      0.05     0.01     0.19 1.00     1198
cor(Intercept,condition1)     0.27      0.41    -0.63     0.89 1.00     1552
                          Tail_ESS
sd(Intercept)                 1284
sd(condition1)                1456
cor(Intercept,condition1)     1689

~subj (Number of levels: 42) 
                          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                 0.33      0.04     0.26     0.41 1.00      884
sd(condition1)                0.23      0.04     0.15     0.32 1.00     1831
cor(Intercept,condition1)     0.51      0.16     0.15     0.79 1.00     1725
                          Tail_ESS
sd(Intercept)                 1545
sd(condition1)                2535
cor(Intercept,condition1)     1690

Regression Coefficients:
           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept      5.88      0.05     5.77     5.98 1.01      400      911
condition1     0.10      0.05     0.01     0.19 1.00     1329     2354

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.36      0.01     0.34     0.38 1.00     3195     2719

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</div>
</div>
<ol type="a">
<li>Examine the effect of relative clause attachment site (the predictor <code>c_cond</code>) on reading times RT (<span class="math inline">\(\beta\)</span>).</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
My solution
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>the effect of RC attachment on RT on the log scale is</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_df_gg05_rc, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate  Est.Error       Q2.5     Q97.5
b_condition1 0.1003678 0.04582792 0.01239481 0.1890053</code></pre>
</div>
</div>
</div>
</div>
<ol start="2" type="a">
<li>Estimate the median difference between relative clause attachment sites in milliseconds, and report the mean and 95% CI.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
My solution
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc)<span class="sc">$</span>b_Intercept</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc)<span class="sc">$</span>b_condition1</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Difference between object RC coded as .5 and subject RC coded as .5 </span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>effect <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha <span class="sc">+</span> beta <span class="sc">*</span> .<span class="dv">5</span>) <span class="sc">-</span> <span class="fu">exp</span>(alpha <span class="sc">+</span> beta <span class="sc">*</span> <span class="sc">-</span>.<span class="dv">5</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">mean =</span> <span class="fu">mean</span>(effect), <span class="fu">quantile</span>(effect, <span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     mean      2.5%     97.5% 
36.129476  4.483022 71.120079 </code></pre>
</div>
</div>
</div>
</div>
<ol start="3" type="a">
<li>Do a sensitivity analysis. What is the estimate of the effect (<span class="math inline">\(\beta\)</span>) under different priors? What is the difference in milliseconds between conditions under different priors?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
My solution
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>first let’s check out the fit of the model</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit_df_gg05_rc, <span class="at">ndraws =</span> <span class="dv">50</span>, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>now by participants</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay_grouped</span>(df_gg05_rc<span class="sc">$</span>RT,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrep =</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">posterior_predict</span>(fit_df_gg05_rc,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ndraws =</span> <span class="dv">100</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> df_gg05_rc<span class="sc">$</span>subj</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Signal in the N400 spatiotemporal window"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>and by sd</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit_df_gg05_rc,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"stat_grouped"</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">1000</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"subj"</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">stat =</span> <span class="st">"sd"</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_df_gg05_rc, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate  Est.Error       Q2.5     Q97.5
b_condition1 0.1003678 0.04582792 0.01239481 0.1890053</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_df_gg05_rc, <span class="at">variable =</span> <span class="st">"b_Intercept"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Est.Error     Q2.5    Q97.5
b_Intercept 5.875583 0.0535306 5.772643 5.982605</code></pre>
</div>
</div>
<ul>
<li>our posteriors are pretty close to our priors</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">prior_summary</span>(fit_df_gg05_rc)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                prior     class       coef group resp dpar nlpar lb ub
       normal(0, 0.1)         b                                       
       normal(0, 0.1)         b condition1                            
       normal(6, 1.5) Intercept                                       
 lkj_corr_cholesky(2)         L                                       
 lkj_corr_cholesky(2)         L             item                      
 lkj_corr_cholesky(2)         L             subj                      
         normal(0, 1)        sd                                   0   
         normal(0, 1)        sd             item                  0   
         normal(0, 1)        sd condition1  item                  0   
         normal(0, 1)        sd  Intercept  item                  0   
         normal(0, 1)        sd             subj                  0   
         normal(0, 1)        sd condition1  subj                  0   
         normal(0, 1)        sd  Intercept  subj                  0   
         normal(0, 1)     sigma                                   0   
       source
         user
 (vectorized)
         user
         user
 (vectorized)
 (vectorized)
         user
 (vectorized)
 (vectorized)
 (vectorized)
 (vectorized)
 (vectorized)
 (vectorized)
         user</code></pre>
</div>
</div>
<ul>
<li>let’s see if this is due to the influence of our priors. Let’s start with <em>narrower</em> prior</li>
</ul>
<p><span class="math display">\[
\beta \sim Normal(0,.01)
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fit_df_gg05_rc_tight <span class="ot">&lt;-</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    RT <span class="sc">~</span> condition <span class="sc">+</span> (condition <span class="sc">|</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                     subj) <span class="sc">+</span> (condition <span class="sc">|</span> item),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">6</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, .<span class="dv">01</span>), <span class="at">class =</span> b),</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_gg05_rc,</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_df_gg05_rc_tight"</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>fit_df_gg05_rc_tight</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: lognormal 
  Links: mu = identity; sigma = identity 
Formula: RT ~ condition + (condition | subj) + (condition | item) 
   Data: df_gg05_rc (Number of observations: 672) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~item (Number of levels: 16) 
                          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                 0.04      0.02     0.00     0.09 1.00     1265
sd(condition1)                0.11      0.05     0.01     0.22 1.00      907
cor(Intercept,condition1)     0.31      0.39    -0.58     0.89 1.00     1197
                          Tail_ESS
sd(Intercept)                 1234
sd(condition1)                 654
cor(Intercept,condition1)     1763

~subj (Number of levels: 42) 
                          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                 0.33      0.04     0.26     0.41 1.01      712
sd(condition1)                0.24      0.04     0.16     0.33 1.01     1205
cor(Intercept,condition1)     0.50      0.16     0.15     0.79 1.00     1143
                          Tail_ESS
sd(Intercept)                 1193
sd(condition1)                1938
cor(Intercept,condition1)     1808

Regression Coefficients:
           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept      5.84      0.05     5.74     5.95 1.01      508      805
condition1     0.00      0.01    -0.02     0.02 1.00     4631     3025

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.36      0.01     0.34     0.38 1.00     3557     2876

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_df_gg05_rc_tight, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate   Est.Error        Q2.5      Q97.5
b_condition1 0.003929963 0.009915301 -0.01567115 0.02344023</code></pre>
</div>
</div>
<ul>
<li>and now a <em>wider</em> prior</li>
</ul>
<p><span class="math display">\[
\beta \sim Normal(0,1)
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>fit_df_gg05_rc_wide <span class="ot">&lt;-</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    RT <span class="sc">~</span> condition <span class="sc">+</span> (condition <span class="sc">|</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                     subj) <span class="sc">+</span> (condition <span class="sc">|</span> item),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">6</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_gg05_rc,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_df_gg05_rc_wide"</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>fit_df_gg05_rc_wide</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: lognormal 
  Links: mu = identity; sigma = identity 
Formula: RT ~ condition + (condition | subj) + (condition | item) 
   Data: df_gg05_rc (Number of observations: 672) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~item (Number of levels: 16) 
                          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                 0.04      0.02     0.00     0.09 1.00     1400
sd(condition1)                0.09      0.05     0.01     0.18 1.00     1344
cor(Intercept,condition1)     0.29      0.40    -0.60     0.89 1.00     2134
                          Tail_ESS
sd(Intercept)                 1510
sd(condition1)                1348
cor(Intercept,condition1)     1927

~subj (Number of levels: 42) 
                          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                 0.33      0.04     0.26     0.42 1.00      917
sd(condition1)                0.23      0.04     0.15     0.31 1.00     1961
cor(Intercept,condition1)     0.51      0.17     0.14     0.79 1.00     1968
                          Tail_ESS
sd(Intercept)                 1677
sd(condition1)                2799
cor(Intercept,condition1)     2539

Regression Coefficients:
           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept      5.88      0.05     5.77     5.98 1.01      646     1326
condition1     0.12      0.05     0.02     0.22 1.00     1458     2394

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.36      0.01     0.34     0.38 1.00     3910     3020

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_df_gg05_rc_wide, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate  Est.Error       Q2.5     Q97.5
b_condition1 0.1202535 0.04996971 0.02286224 0.2188892</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">posterior_summary</span>(fit_df_gg05_rc, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Prior for $</span><span class="sc">\\</span><span class="st">beta$"</span> <span class="ot">=</span> <span class="st">"Normal(0,.1)"</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>tight <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">posterior_summary</span>(fit_df_gg05_rc_tight, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Prior for $</span><span class="sc">\\</span><span class="st">beta$"</span> <span class="ot">=</span> <span class="st">"Normal(0,.01)"</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>wide <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">posterior_summary</span>(fit_df_gg05_rc_wide, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Prior for $</span><span class="sc">\\</span><span class="st">beta$"</span> <span class="ot">=</span> <span class="st">"Normal(0,1)"</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>sens_priors <span class="ot">&lt;-</span> <span class="fu">rbind</span>(prior,tight,wide)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">prior_summary</span>(fit_df_gg05_rc_wide)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                prior     class       coef group resp dpar nlpar lb ub
         normal(0, 1)         b                                       
         normal(0, 1)         b condition1                            
       normal(6, 1.5) Intercept                                       
 lkj_corr_cholesky(2)         L                                       
 lkj_corr_cholesky(2)         L             item                      
 lkj_corr_cholesky(2)         L             subj                      
         normal(0, 1)        sd                                   0   
         normal(0, 1)        sd             item                  0   
         normal(0, 1)        sd condition1  item                  0   
         normal(0, 1)        sd  Intercept  item                  0   
         normal(0, 1)        sd             subj                  0   
         normal(0, 1)        sd condition1  subj                  0   
         normal(0, 1)        sd  Intercept  subj                  0   
         normal(0, 1)     sigma                                   0   
       source
         user
 (vectorized)
         user
         user
 (vectorized)
 (vectorized)
         user
 (vectorized)
 (vectorized)
 (vectorized)
 (vectorized)
 (vectorized)
 (vectorized)
         user</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>sens_priors <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Est.Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q2.5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q97.5</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Prior for $\beta$</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b_condition1</td>
<td style="text-align: right;">0.1003678</td>
<td style="text-align: right;">0.0458279</td>
<td style="text-align: right;">0.0123948</td>
<td style="text-align: right;">0.1890053</td>
<td style="text-align: left;">Normal(0,.1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">b_condition11</td>
<td style="text-align: right;">0.0039300</td>
<td style="text-align: right;">0.0099153</td>
<td style="text-align: right;">-0.0156712</td>
<td style="text-align: right;">0.0234402</td>
<td style="text-align: left;">Normal(0,.01)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b_condition12</td>
<td style="text-align: right;">0.1202535</td>
<td style="text-align: right;">0.0499697</td>
<td style="text-align: right;">0.0228622</td>
<td style="text-align: right;">0.2188892</td>
<td style="text-align: left;">Normal(0,1)</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<ul>
<li>and now in milliseconds</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc)<span class="sc">$</span>b_Intercept </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc)<span class="sc">$</span>b_condition1</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>diff1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha1 <span class="sc">+</span> beta1<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">exp</span>(alpha1 <span class="sc">-</span> beta1<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>prior_ms <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mean =</span> <span class="fu">mean</span>(diff1), <span class="fu">quantile</span>(diff1, .<span class="dv">025</span>), <span class="fu">quantile</span>(diff1, .<span class="dv">975</span>), <span class="at">row.names =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Estimate (ms)"</span> <span class="ot">=</span> <span class="st">"mean"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2.5%"</span> <span class="ot">=</span> <span class="st">"quantile.diff1..0.025."</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">"97.5%"</span> <span class="ot">=</span> <span class="st">"quantile.diff1..0.975."</span>)<span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Prior for $</span><span class="sc">\\</span><span class="st">beta$"</span> <span class="ot">=</span> <span class="st">"Normal(0,.1)"</span>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc_tight)<span class="sc">$</span>b_Intercept </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc_tight)<span class="sc">$</span>b_condition1</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>diff1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha1 <span class="sc">+</span> beta1<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">exp</span>(alpha1 <span class="sc">-</span> beta1<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>tight_ms <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mean =</span> <span class="fu">mean</span>(diff1), <span class="fu">quantile</span>(diff1, .<span class="dv">025</span>), <span class="fu">quantile</span>(diff1, .<span class="dv">975</span>), <span class="at">row.names =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Estimate (ms)"</span> <span class="ot">=</span> <span class="st">"mean"</span>,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2.5%"</span> <span class="ot">=</span> <span class="st">"quantile.diff1..0.025."</span>,</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">"97.5%"</span> <span class="ot">=</span> <span class="st">"quantile.diff1..0.975."</span>)<span class="sc">%&gt;%</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Prior for $</span><span class="sc">\\</span><span class="st">beta$"</span> <span class="ot">=</span> <span class="st">"Normal(0,.01)"</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc_wide)<span class="sc">$</span>b_Intercept </span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc_wide)<span class="sc">$</span>b_condition1</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>diff1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha1 <span class="sc">+</span> beta1<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">exp</span>(alpha1 <span class="sc">-</span> beta1<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>wide_ms <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mean =</span> <span class="fu">mean</span>(diff1), <span class="fu">quantile</span>(diff1, .<span class="dv">025</span>), <span class="fu">quantile</span>(diff1, .<span class="dv">975</span>), <span class="at">row.names =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Estimate (ms)"</span> <span class="ot">=</span> <span class="st">"mean"</span>,</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2.5%"</span> <span class="ot">=</span> <span class="st">"quantile.diff1..0.025."</span>,</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>         <span class="st">"97.5%"</span> <span class="ot">=</span> <span class="st">"quantile.diff1..0.975."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Prior for $</span><span class="sc">\\</span><span class="st">beta$"</span> <span class="ot">=</span> <span class="st">"Normal(0,1)"</span>)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>priors_ms <span class="ot">&lt;-</span> <span class="fu">rbind</span>(prior_ms,tight_ms,wide_ms) <span class="sc">%&gt;%</span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effect =</span> <span class="st">"b_condition1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(effect, <span class="at">.before=</span><span class="st">"Estimate (ms)"</span>)</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>priors_ms <span class="sc">%&gt;%</span> </span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">effect</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate (ms)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2.5%</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">97.5%</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Prior for $\beta$</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b_condition1</td>
<td style="text-align: right;">36.129476</td>
<td style="text-align: right;">4.483022</td>
<td style="text-align: right;">71.120079</td>
<td style="text-align: left;">Normal(0,.1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">b_condition1</td>
<td style="text-align: right;">1.362536</td>
<td style="text-align: right;">-5.366546</td>
<td style="text-align: right;">8.218174</td>
<td style="text-align: left;">Normal(0,.01)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b_condition1</td>
<td style="text-align: right;">43.454009</td>
<td style="text-align: right;">7.983291</td>
<td style="text-align: right;">82.243742</td>
<td style="text-align: left;">Normal(0,1)</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<ul>
<li>we see lots of variation in estimates as a function of our priors
<ul>
<li>with the tight priors, there is a lot more uncertainty</li>
<li>with the regularised and wider priors the effects are a bit more similar</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># these are all the intercept, i'm interested in the slope though :/</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pp_check</span>(fit_df_gg05_rc_wide, <span class="at">type =</span> <span class="st">"stat"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Wide priors N(0,1)"</span>),</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pp_check</span>(fit_df_gg05_rc_tight, <span class="at">type =</span> <span class="st">"stat"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Tight priors N(0,.01)"</span>),</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pp_check</span>(fit_df_gg05_rc, <span class="at">type =</span> <span class="st">"stat"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Original priors N(0,.1)"</span>),</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="at">nrow =</span> <span class="dv">3</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="exercise-5.3-relative-clause-processing-in-mandarin-chinese" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="exercise-5.3-relative-clause-processing-in-mandarin-chinese"><span class="header-section-number">7.3</span> Exercise 5.3 Relative clause processing in Mandarin Chinese</h2>
<p>Load the following two data sets:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_gibsonwu"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_gibsonwu2"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data are taken from two experiments that investigate (inter alia) the effect of relative clause type on reading time in Chinese. The data are from Gibson and Wu (2013) and Vasishth et al.&nbsp;(2013) respectively. The second data set is a direct replication attempt of the Gibson and Wu (2013) experiment.</p>
<p>Chinese relative clauses are interesting theoretically because they are prenominal: the relative clause appears before the head noun. For example, the English relative clauses shown above would appear in the following order in Mandarin. The square brackets mark the relative clause, and REL refers to the Chinese equivalent of the English relative pronoun who.</p>
<p>(2a) [The photographer sent to the editor] REL the reporter was hoping for a good story. (ORC)</p>
<p>(2b) [sent the photographer to the editor] REL the reporter who was hoping for a good story. (SRC)</p>
<p>As discussed in Gibson and Wu (2013), the consequence of Chinese relative clauses being prenominal is that the distance between the verb in relative clause and the head noun is larger in subject relatives than object relatives. Hsiao and Gibson (2003) were the first to suggest that the larger distance in subject relatives leads to longer reading time at the head noun. Under this view, the prediction is that subject relatives are harder to process than object relatives. If this is true, this is interesting and surprising because in most other languages that have been studied, subject relatives are easier to process than object relatives; so Chinese will be a very unusual exception cross-linguistically.</p>
<p>The data provided are for the critical region (the head noun; here, reporter). The experiment method is self-paced reading, so we have reading times in milliseconds. The second data set is a direct replication attempt of the first data set, which is from Gibson and Wu (2013).</p>
<p>The research hypothesis is whether the difference in reading times between object and subject relative clauses is negative. For the first data set (<code>df_gibsonwu</code>), investigate this question by fitting two “maximal” hierarchical models (correlated varying intercept and slopes for subjects and items). The dependent variable in both models is the raw reading time in milliseconds. The first model should use the normal likelihood in the model; the second model should use the log-normal likelihood. In both models, use <span class="math inline">\(\pm 0.5\)</span> sum coding to model the effect of relative clause type. You will need to decide on appropriate priors for the various parameters.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contrasts
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>obj-ext = -0.5</code>, <code>subj-ext = 0.5</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_gibsonwu)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    subj item     type   rt
94     1   13  obj-ext 1561
221    1    6 subj-ext  959
341    1    5  obj-ext  582
461    1    9  obj-ext  294
621    1   14 subj-ext  438
753    1    4 subj-ext  286</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>df_gibsonwu<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_gibsonwu<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"obj-ext"</span>,<span class="st">"subj-ext"</span>))</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gibsonwu<span class="sc">$</span>type) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gibsonwu<span class="sc">$</span>type)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
obj-ext   0.5
subj-ext -0.5</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Normal likelihood
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>first set priors</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>priors_gw_norm <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(500, 150)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,500)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"type1"</span>),</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,500)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1000)"</span>,<span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"lkj(2)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>fit model</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>fit_gw_norm <span class="ot">&lt;-</span> <span class="fu">brm</span>(rt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> type <span class="sc">+</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span> type <span class="sc">|</span> subj) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span> type <span class="sc">|</span> item), </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_gibsonwu,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> priors_gw_norm,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_gw_norm"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Log-normal likelihood
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>set priors</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>priors_gw_log <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(6, 1.5)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"type1"</span>),</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sd"</span>),</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"lkj(2)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>fit model</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>fit_gw_log <span class="ot">&lt;-</span> <span class="fu">brm</span>(rt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> type <span class="sc">+</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span> type <span class="sc">|</span> subj) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span> type <span class="sc">|</span> item), </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_gibsonwu,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> priors_gw_log,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_gw_log"</span>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<ol type="a">
<li>Plot the posterior predictive distributions from the two models. What is the difference in the posterior predictive distributions of the two models; and why is there a difference?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Posterior predictive distributions
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pp_check</span>(fit_gw_norm, <span class="at">ndraws =</span> <span class="dv">1000</span>) <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Normal distr"</span>) <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>),</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pp_check</span>(fit_gw_log, <span class="at">ndraws =</span> <span class="dv">1000</span>) <span class="sc">+</span> </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Log-normal distr"</span>) <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>),</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  cowplot<span class="sc">::</span><span class="fu">get_legend</span>(<span class="fu">pp_check</span>(fit_gw_log) <span class="sc">+</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)),</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(.<span class="dv">45</span>,.<span class="dv">45</span>,.<span class="dv">1</span>)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>quite a mismatch in normal likelihood model, e.g., negative values are generated</li>
<li>log-normal better fit</li>
</ul>
</div>
</div>
<ol start="2" type="a">
<li>Examine the posterior distributions of the effect estimates (in milliseconds) in the two models. Why are these different?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Posterior distribution
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal distr</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_gw_norm)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log distr</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_gw_log)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-43-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="effect-estimates" class="level5" data-number="7.3.0.0.1">
<h5 data-number="7.3.0.0.1" class="anchored" data-anchor-id="effect-estimates"><span class="header-section-number">7.3.0.0.1</span> Effect estimates</h5>
<ul>
<li>look at effect estimates</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normal distr</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>gw_intercept_norm <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw_norm)<span class="sc">$</span>b_Intercept</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>gw_slope_norm <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw_norm)<span class="sc">$</span>b_type1</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>gw_RT_diff_norm <span class="ot">&lt;-</span> gw_slope_norm</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">quantile</span>(gw_RT_diff_norm,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   2.5%   97.5% 
-249.37   17.18 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log distr</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>gw_intercept_log <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw_log)<span class="sc">$</span>b_Intercept</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>gw_slope_log <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw_log)<span class="sc">$</span>b_type1</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>gw_RT_diff_log <span class="ot">&lt;-</span> <span class="fu">exp</span>(gw_intercept_log <span class="sc">+</span> gw_slope_log<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(gw_intercept_log <span class="sc">-</span> gw_slope_log<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(gw_RT_diff_log,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
-79.89632  14.21774 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(rt<span class="sc">~</span>type,df_gibsonwu)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>95% credible interval for estimates include 0 for both norm and log-norm distributions</li>
<li>log-norm model CrI is tighter, and includes smaller effect size (but includes 0)</li>
</ul>
</section>
</div>
</div>
<ol start="3" type="a">
<li>Given the posterior predictive distributions you plotted above, why is the log-normal likelihood model better for carrying out inference and hypothesis testing?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at range per type</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>df_gibsonwu <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">min</span>(rt), <span class="fu">max</span>(rt))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  type     `min(rt)` `max(rt)`
  &lt;fct&gt;        &lt;int&gt;     &lt;int&gt;
1 obj-ext        172      2308
2 subj-ext       189      6217</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrain) </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>df_gibsonwu <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(session!="bi") %&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(px_list = paste0(participant,list)) %&gt;%</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> rt, </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> type, <span class="at">color =</span> type, <span class="at">shape =</span> type)) <span class="sc">+</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of observations"</span>) <span class="sc">+</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rain</span>(<span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">rain.side =</span> <span class="st">'f1x1'</span>,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">violin.args =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"dodgerblue"</span>, <span class="st">"darkorange"</span>)) <span class="sc">+</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"dodgerblue"</span>, <span class="st">"darkorange"</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="my-answer" class="level4" data-number="7.3.0.1">
<h4 data-number="7.3.0.1" class="anchored" data-anchor-id="my-answer"><span class="header-section-number">7.3.0.1</span> My answer</h4>
<ul>
<li>subj-ext had extreme raw values; this would’ve biased the model with a normal distribution</li>
</ul>
</section>
</div>
</div>
<p>Next, work out a normal approximation of the log-normal model’s posterior distribution for the relative clause effect that you obtained from the above data analysis. Then use that normal approximation as an informative prior for the slope parameter when fitting a hierarchical model to the second data set. This is an example of incrementally building up knowledge by successively using a previous study’s posterior as a prior for the next study; this is essentially equivalent to pooling both data sets (check that pooling the data and using a Normal(0,1) prior for the effect of interest, with a log-normal likelihood, gives you approximately the same posterior as the informative-prior model fit above).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dataset 1 log estimates
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>first check 2nd dataset</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_gibsonwu2)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   subj item condition pos   rt    region
9   1m1   15   obj-ext   8  832 head noun
20  1m1    8  subj-ext   8 2131 head noun
33  1m1   11   obj-ext   8  553 head noun
46  1m1   10  subj-ext   8 1091 head noun
62  1m1   16  subj-ext   8  598 head noun
75  1m1   14  subj-ext   8  645 head noun</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>df_gibsonwu2 <span class="ot">&lt;-</span> df_gibsonwu2 <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"type"</span> <span class="ot">=</span> condition)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>df_gibsonwu2<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_gibsonwu2<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"obj-ext"</span>,<span class="st">"subj-ext"</span>))</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gibsonwu2<span class="sc">$</span>type) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gibsonwu2<span class="sc">$</span>type)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
obj-ext   0.5
subj-ext -0.5</code></pre>
</div>
</div>
<ul>
<li>remind ourselves of the estimates from the first dataset</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_gw_log)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: lognormal 
  Links: mu = identity; sigma = identity 
Formula: rt ~ 1 + type + (1 + type | subj) + (1 + type | item) 
   Data: df_gibsonwu (Number of observations: 547) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~item (Number of levels: 15) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.20      0.05     0.12     0.32 1.00     1220
sd(type1)                0.07      0.05     0.00     0.20 1.00     1857
cor(Intercept,type1)     0.00      0.42    -0.77     0.77 1.00     3914
                     Tail_ESS
sd(Intercept)            2098
sd(type1)                1710
cor(Intercept,type1)     2698

~subj (Number of levels: 37) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.25      0.04     0.18     0.33 1.00     1286
sd(type1)                0.14      0.07     0.01     0.27 1.00     1415
cor(Intercept,type1)    -0.46      0.31    -0.91     0.29 1.00     2380
                     Tail_ESS
sd(Intercept)            2128
sd(type1)                1198
cor(Intercept,type1)     1911

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     6.06      0.07     5.92     6.20 1.00      791     1214
type1        -0.07      0.05    -0.18     0.03 1.00     2529     2729

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.51      0.02     0.48     0.55 1.00     3927     2662

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<ul>
<li>for replication study, use:
<ul>
<li>type: <span class="math inline">\(LogNormal(-0.07, 0.07)\)</span> (<code>type1</code> Estimate and Est. Error?)</li>
<li>Intercept: <span class="math inline">\(LogNormal(6, 0.06)\)</span></li>
</ul></li>
</ul>
<section id="dataset-2-model" class="level4" data-number="7.3.0.2">
<h4 data-number="7.3.0.2" class="anchored" data-anchor-id="dataset-2-model"><span class="header-section-number">7.3.0.2</span> Dataset 2 model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>priors_gw2_log <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(6, 0.07)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(-0.7,0.06)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"type1"</span>),</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sd"</span>),</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"lkj(2)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>fit model; convergence warning (ESS too low)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>fit_gw2_log <span class="ot">&lt;-</span> <span class="fu">brm</span>(rt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> type <span class="sc">+</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span> type <span class="sc">|</span> subj) <span class="sc">+</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span> type <span class="sc">|</span> item), </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_gibsonwu2,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> priors_gw2_log,</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_gw2_log"</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_gw2_log)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: lognormal 
  Links: mu = identity; sigma = identity 
Formula: rt ~ 1 + type + (1 + type | subj) + (1 + type | item) 
   Data: df_gibsonwu2 (Number of observations: 595) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~item (Number of levels: 15) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.17      0.04     0.10     0.27 1.00     1486
sd(type1)                0.61      0.14     0.38     0.95 1.00     1333
cor(Intercept,type1)    -0.29      0.31    -0.80     0.39 1.01      435
                     Tail_ESS
sd(Intercept)            2355
sd(type1)                1818
cor(Intercept,type1)     1180

~subj (Number of levels: 40) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.24      0.04     0.18     0.32 1.00     1244
sd(type1)                0.11      0.07     0.00     0.24 1.00      755
cor(Intercept,type1)     0.03      0.34    -0.64     0.68 1.00     4172
                     Tail_ESS
sd(Intercept)            2371
sd(type1)                1058
cor(Intercept,type1)     2261

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     6.03      0.05     5.92     6.13 1.00      853     1685
type1        -0.61      0.06    -0.74    -0.49 1.00     3451     2808

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.43      0.01     0.40     0.46 1.00     3663     2768

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_gw2_log)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-54-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="estimates" class="level5" data-number="7.3.0.2.1">
<h5 data-number="7.3.0.2.1" class="anchored" data-anchor-id="estimates"><span class="header-section-number">7.3.0.2.1</span> Estimates</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log distr</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>gw2_intercept_log <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw2_log)<span class="sc">$</span>b_Intercept</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>gw2_slope_log <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw2_log)<span class="sc">$</span>b_type1</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>gw2_RT_diff_log <span class="ot">&lt;-</span> <span class="fu">exp</span>(gw2_intercept_log <span class="sc">+</span> gw2_slope_log<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">exp</span>(gw2_intercept_log <span class="sc">-</span> gw2_slope_log<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(gw2_RT_diff_log,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
-321.2215 -202.9674 </code></pre>
</div>
</div>
</section>
</section>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Datasets 1 and 2
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make sure 2 datasets have same column names/order</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df_gibsonwu); <span class="fu">names</span>(df_gibsonwu2)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "subj" "item" "type" "rt"  </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "subj"   "item"   "type"   "pos"    "rt"     "region"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>df_gibsonwu2 <span class="ot">&lt;-</span> df_gibsonwu2 <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subj,item,type,rt) <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subj =</span> <span class="fu">paste0</span>(subj,<span class="st">"_gw2"</span>),</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">item =</span> <span class="fu">paste0</span>(item,<span class="st">"_gw2"</span>))</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>df_gibsonwu <span class="ot">&lt;-</span> df_gibsonwu <span class="sc">%&gt;%</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subj =</span> <span class="fu">paste0</span>(subj,<span class="st">"_gw1"</span>),</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">item =</span> <span class="fu">paste0</span>(item,<span class="st">"_gw1"</span>))</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df_gibsonwu) <span class="sc">==</span> <span class="fu">names</span>(df_gibsonwu2)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE TRUE TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>df_gw12 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_gibsonwu,df_gibsonwu2)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="informative-model" class="level5" data-number="7.3.0.2.2">
<h5 data-number="7.3.0.2.2" class="anchored" data-anchor-id="informative-model"><span class="header-section-number">7.3.0.2.2</span> Informative model</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_gw12)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     subj   item     type   rt
94  1_gw1 13_gw1  obj-ext 1561
221 1_gw1  6_gw1 subj-ext  959
341 1_gw1  5_gw1  obj-ext  582
461 1_gw1  9_gw1  obj-ext  294
621 1_gw1 14_gw1 subj-ext  438
753 1_gw1  4_gw1 subj-ext  286</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>df_gw12<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_gw12<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"obj-ext"</span>,<span class="st">"subj-ext"</span>))</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gw12<span class="sc">$</span>type) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gw12<span class="sc">$</span>type)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]
obj-ext   0.5
subj-ext -0.5</code></pre>
</div>
</div>
<ul>
<li>same priors as based on previous models</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>priors_gw12_log <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(6, 0.07)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(-0.7,0.06)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"type1"</span>),</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sd"</span>),</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"lkj(2)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>fit_gw12_log <span class="ot">&lt;-</span> <span class="fu">brm</span>(rt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> type <span class="sc">+</span> </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span> type <span class="sc">|</span> subj) <span class="sc">+</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span> type <span class="sc">|</span> item), </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_gw12,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> priors_gw12_log,</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_gw12_log"</span>)</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_gw12_log)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: lognormal 
  Links: mu = identity; sigma = identity 
Formula: rt ~ 1 + type + (1 + type | subj) + (1 + type | item) 
   Data: df_gw12 (Number of observations: 1142) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~item (Number of levels: 30) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.18      0.03     0.13     0.24 1.00     1488
sd(type1)                0.45      0.10     0.26     0.67 1.00     1081
cor(Intercept,type1)    -0.12      0.29    -0.64     0.45 1.02      433
                     Tail_ESS
sd(Intercept)            2112
sd(type1)                1515
cor(Intercept,type1)     1052

~subj (Number of levels: 77) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.24      0.03     0.20     0.30 1.00     1497
sd(type1)                0.12      0.05     0.02     0.22 1.00      806
cor(Intercept,type1)    -0.33      0.28    -0.82     0.27 1.00     4190
                     Tail_ESS
sd(Intercept)            2569
sd(type1)                1344
cor(Intercept,type1)     2368

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     6.04      0.05     5.95     6.13 1.01      701     1576
type1        -0.49      0.07    -0.63    -0.35 1.00     1574     2408

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.47      0.01     0.45     0.49 1.00     4636     3007

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_gw12_log)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-61-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estimates-1" class="level5" data-number="7.3.0.2.3">
<h5 data-number="7.3.0.2.3" class="anchored" data-anchor-id="estimates-1"><span class="header-section-number">7.3.0.2.3</span> Estimates</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log distr</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>gw12_intercept_log <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw12_log)<span class="sc">$</span>b_Intercept</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>gw12_slope_log <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw12_log)<span class="sc">$</span>b_type1</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>gw12_RT_diff_log <span class="ot">&lt;-</span> <span class="fu">exp</span>(gw12_intercept_log <span class="sc">+</span> gw12_slope_log<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">exp</span>(gw12_intercept_log <span class="sc">-</span> gw12_slope_log<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(gw12_RT_diff_log,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
-272.3808 -146.4277 </code></pre>
</div>
</div>
<ul>
<li>negative slope, CrI doesn’t include 0</li>
</ul>
</section>
<section id="regularised-prior" class="level4" data-number="7.3.0.3">
<h4 data-number="7.3.0.3" class="anchored" data-anchor-id="regularised-prior"><span class="header-section-number">7.3.0.3</span> Regularised prior?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>priors_gw12_log_reg <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(6, 1.5)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"type1"</span>),</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sd"</span>),</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"lkj(2)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>)</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>fit_gw12_log_reg <span class="ot">&lt;-</span> <span class="fu">brm</span>(rt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> type <span class="sc">+</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span> type <span class="sc">|</span> subj) <span class="sc">+</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span> type <span class="sc">|</span> item), </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_gw12,</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> priors_gw12_log_reg,</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_gw12_log_reg"</span>)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_gw12_log_reg)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: lognormal 
  Links: mu = identity; sigma = identity 
Formula: rt ~ 1 + type + (1 + type | subj) + (1 + type | item) 
   Data: df_gw12 (Number of observations: 1142) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~item (Number of levels: 30) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.17      0.03     0.12     0.24 1.00     1269
sd(type1)                0.11      0.05     0.01     0.21 1.01     1063
cor(Intercept,type1)    -0.29      0.31    -0.82     0.39 1.00     2244
                     Tail_ESS
sd(Intercept)            1767
sd(type1)                1150
cor(Intercept,type1)     2001

~subj (Number of levels: 77) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.25      0.03     0.20     0.30 1.00     1226
sd(type1)                0.10      0.05     0.01     0.20 1.00      988
cor(Intercept,type1)    -0.34      0.29    -0.83     0.31 1.00     2636
                     Tail_ESS
sd(Intercept)            1954
sd(type1)                1074
cor(Intercept,type1)     1913

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     6.03      0.04     5.95     6.12 1.00      858     1436
type1        -0.08      0.04    -0.16    -0.00 1.00     2156     2379

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.47      0.01     0.45     0.49 1.00     2851     2765

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(fit_gw12_log_reg)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                prior     class      coef group resp dpar nlpar lb ub
               (flat)         b                                      
          normal(0,1)         b     type1                            
       normal(6, 1.5) Intercept                                      
 lkj_corr_cholesky(2)         L                                      
 lkj_corr_cholesky(2)         L            item                      
 lkj_corr_cholesky(2)         L            subj                      
          normal(0,1)        sd                                  0   
          normal(0,1)        sd            item                  0   
          normal(0,1)        sd Intercept  item                  0   
          normal(0,1)        sd     type1  item                  0   
          normal(0,1)        sd            subj                  0   
          normal(0,1)        sd Intercept  subj                  0   
          normal(0,1)        sd     type1  subj                  0   
          normal(0,1)     sigma                                  0   
       source
      default
         user
         user
         user
 (vectorized)
 (vectorized)
         user
 (vectorized)
 (vectorized)
 (vectorized)
 (vectorized)
 (vectorized)
 (vectorized)
         user</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_gw12_log_reg)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch5_exercises_files/figure-html/unnamed-chunk-66-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="estimates-2" class="level5" data-number="7.3.0.3.1">
<h5 data-number="7.3.0.3.1" class="anchored" data-anchor-id="estimates-2"><span class="header-section-number">7.3.0.3.1</span> Estimates</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log distr</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>gw12_intercept_log_reg <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw12_log_reg)<span class="sc">$</span>b_Intercept</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>gw12_slope_log_reg <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw12_log_reg)<span class="sc">$</span>b_type1</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>gw12_RT_diff_log_reg <span class="ot">&lt;-</span> <span class="fu">exp</span>(gw12_intercept_log_reg <span class="sc">+</span> gw12_slope_log_reg<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> </span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(gw12_intercept_log_reg <span class="sc">-</span> gw12_slope_log_reg<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(gw12_RT_diff_log_reg,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      2.5%      97.5% 
-65.965900  -1.192242 </code></pre>
</div>
</div>
<ul>
<li>now the 95% CrI does not include 0, but the range of values is much tighter and includes smaller values</li>
</ul>
</section>
</section>
</div>
</div>
</section>
<section id="exercise-5.4---agreement-attraction-in-comprehension" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="exercise-5.4---agreement-attraction-in-comprehension"><span class="header-section-number">7.4</span> Exercise 5.4 - Agreement attraction in comprehension</h2>
<p>Load the following data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_dillonE1"</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>dillonE1 <span class="ot">&lt;-</span> df_dillonE1</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dillonE1)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        subj       item   rt int     expt
49 dillonE11 dillonE119 2918 low dillonE1
56 dillonE11 dillonE119 1338 low dillonE1
63 dillonE11 dillonE119  424 low dillonE1
70 dillonE11 dillonE119  186 low dillonE1
77 dillonE11 dillonE119  195 low dillonE1
84 dillonE11 dillonE119 1218 low dillonE1</code></pre>
</div>
</div>
<p>The data are taken from an experiment that investigate (inter alia) the effect of number similarity between a noun and the auxiliary verb in sentences like the following. There are two levels to a factor called Int(erference): low and high.</p>
<p>(3a) <em>low</em>: The key to the cabinet are on the table (3b) <em>high</em>: The key to the cabinets are on the table</p>
<p>Here, in (3b), the auxiliary verb are is predicted to be read faster than in (3a), because the plural marking on the noun cabinets leads the reader to think that the sentence is grammatical. (Both sentences are ungrammatical.) This phenomenon, where the high condition is read faster than the low condition, is called <strong>agreement attraction</strong>.</p>
<p>The data provided are for the critical region (the auxiliary verb are). The experiment method is eye-tracking; we have total reading times in milliseconds.</p>
<p>The research question is whether the difference in reading times between high and low conditions is negative.</p>
<ul>
<li>First, using a log-normal likelihood, fit a hierarchical model with correlated varying intercept and slopes for subjects and items. You will need to decide on the priors for the model.</li>
<li>By simply looking at the posterior distribution of the slope parameter, <span class="math inline">\(\beta\)</span>, what would you conclude about the theoretical claim relating to agreement attraction?</li>
</ul>
</section>
<section id="exercise-5.5" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="exercise-5.5"><span class="header-section-number">7.5</span> Exercise 5.5</h2>
</section>
<section id="exercise-5.6" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="exercise-5.6"><span class="header-section-number">7.6</span> Exercise 5.6</h2>
</section>
<section id="exercise-5.7" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="exercise-5.7"><span class="header-section-number">7.7</span> Exercise 5.7</h2>
</section>
<section id="exercise-5.8" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="exercise-5.8"><span class="header-section-number">7.8</span> Exercise 5.8</h2>
</section>
</section>
<section id="session-info" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Session Info</h1>
<p>Compiled with R version 4.4.0 (2024-04-24) (Puppy Cup) in RStudio version 2023.12.1.402 (Ocean Storm).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.0 (2024-04-24)
Platform: aarch64-apple-darwin20
Running under: macOS Ventura 13.2.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Berlin
tzcode source: internal

attached base packages:
[1] grid      stats     graphics  grDevices datasets  utils     methods  
[8] base     

other attached packages:
 [1] ggrain_0.0.4         rstan_2.32.6         StanHeaders_2.32.7  
 [4] rootSolve_1.8.2.4    cmdstanr_0.7.1       pdftools_3.4.0      
 [7] cowplot_1.1.3        lme4_1.1-35.3        Matrix_1.7-0        
[10] gridExtra_2.3        kableExtra_1.4.0     papaja_0.1.2        
[13] tinylabels_0.2.4     bcogsci_0.0.0.9000   hypr_0.2.8          
[16] tictoc_1.2.1         bayesplot_1.11.1     brms_2.21.0         
[19] Rcpp_1.0.12          bridgesampling_1.1-2 loo_2.7.0           
[22] ggplot2_3.5.1        extraDistr_1.10.0    purrr_1.0.2         
[25] tidyr_1.3.1          dplyr_1.1.4          MASS_7.3-60.2       

loaded via a namespace (and not attached):
 [1] tensorA_0.36.2.1     rstudioapi_0.16.0    jsonlite_1.8.8      
 [4] datawizard_0.10.0    magrittr_2.0.3       TH.data_1.1-2       
 [7] estimability_1.5     farver_2.1.1         nloptr_2.0.3        
[10] rmarkdown_2.26       vctrs_0.6.5          minqa_1.2.6         
[13] askpass_1.2.0        effectsize_0.8.7     rstatix_0.7.2       
[16] htmltools_0.5.8.1    polynom_1.4-1        distributional_0.4.0
[19] broom_1.0.5          pracma_2.4.4         htmlwidgets_1.6.4   
[22] plyr_1.8.9           sandwich_3.1-0       emmeans_1.10.1      
[25] zoo_1.8-12           lifecycle_1.0.4      pkgconfig_2.0.3     
[28] R6_2.5.1             fastmap_1.1.1        rbibutils_2.2.16    
[31] digest_0.6.35        colorspace_2.1-0     ps_1.7.6            
[34] rprojroot_2.0.4      ggpubr_0.6.0         labeling_0.4.3      
[37] fansi_1.0.6          abind_1.4-5          compiler_4.4.0      
[40] here_1.0.1           withr_3.0.0          backports_1.4.1     
[43] inline_0.3.19        carData_3.0-5        QuickJSR_1.1.3      
[46] pkgbuild_1.4.4       highr_0.10           ggsignif_0.6.4      
[49] ggpp_0.5.7           tools_4.4.0          glue_1.7.0          
[52] nlme_3.1-164         checkmate_2.3.1      reshape2_1.4.4      
[55] generics_0.1.3       gtable_0.3.5         xml2_1.3.6          
[58] car_3.1-2            utf8_1.2.4           pillar_1.9.0        
[61] stringr_1.5.1        posterior_1.5.0      splines_4.4.0       
[64] lattice_0.22-6       gghalves_0.1.4       renv_1.0.7          
[67] survival_3.5-8       tidyselect_1.2.1     knitr_1.46          
[70] svglite_2.1.3        stats4_4.4.0         xfun_0.43           
[73] matrixStats_1.3.0    stringi_1.8.4        qpdf_1.3.3          
[76] yaml_2.3.8           boot_1.3-30          evaluate_0.23       
[79] codetools_0.2-20     tibble_3.2.1         cli_3.6.2           
[82] RcppParallel_5.1.7   xtable_1.8-4         parameters_0.21.6   
[85] systemfonts_1.0.6    Rdpack_2.6           munsell_0.5.1       
[88] processx_3.8.4       coda_0.19-4.1        parallel_4.4.0      
[91] rstantools_2.4.0     bayestestR_0.13.2    Brobdingnag_1.2-9   
[94] viridisLite_0.4.2    mvtnorm_1.2-4        scales_1.3.0        
[97] insight_0.19.10      rlang_1.1.3          multcomp_1.4-25     </code></pre>
</div>
</div>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" data-custom-style="Bibliography" role="list" style="display: none">

</div>


<!-- -->

</section>

</main> <!-- /main -->
<script>
var custom_title = document.querySelectorAll('.custom .theorem-title');

for (let i = 0; i < custom_title.length; i++ ) {
   var mod_name = custom_title[i].innerHTML;
   custom_title[i].innerHTML = mod_name.replace("Beispiel", "Aufgabe");
};
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../book_exercises/ch1_exercises.html" class="pagination-link" aria-label="Ch. 1 Exercises">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ch. 1 Exercises</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../book_exercises/ch8_exercises.html" class="pagination-link" aria-label="Ch. 8 Exercises">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Ch. 8 Exercises</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb121" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Ch. Exercises"</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Daniela Palleschi"</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co"># format:</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   html:</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     toc: true</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     # html-math-method: katex</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     self-contained: true</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     css: styles.css</span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     number-sections: true</span></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     number-depth: 3</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     code-overflow: wrap</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     code-tools: true</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="co"># bibliography: references.json</span></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a><span class="an">biblio-style:</span><span class="co"> apalike</span></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a><span class="fu"># Set options {-}</span></span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = F}</span></span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a><span class="in"># set global knit options</span></span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a><span class="in"># knitr::opts_chunk$set(echo = T,</span></span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a><span class="in">#                       eval = T,</span></span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a><span class="in">#                       error = F,</span></span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a><span class="in">#                       warning = F,</span></span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a><span class="in">#                       message = F,</span></span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a><span class="in">#                       cache = T)</span></span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a><span class="in"># suppress scientific notation</span></span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a><span class="in">options(scipen=999)</span></span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a><span class="in"># list of required packages</span></span>
<span id="cb121-37"><a href="#cb121-37" aria-hidden="true" tabindex="-1"></a><span class="in">packages &lt;- c( #"SIN", # this package was removed from the CRAN repository</span></span>
<span id="cb121-38"><a href="#cb121-38" aria-hidden="true" tabindex="-1"></a><span class="in">               "MASS", "dplyr", "tidyr", "purrr", "extraDistr", "ggplot2", "loo", "bridgesampling", "brms", "bayesplot", "tictoc", "hypr", "bcogsci", "papaja", "grid", "kableExtra", "gridExtra", "lme4", "cowplot", "pdftools", "cmdstanr", "rootSolve", "rstan"</span></span>
<span id="cb121-39"><a href="#cb121-39" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb121-40"><a href="#cb121-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-41"><a href="#cb121-41" aria-hidden="true" tabindex="-1"></a><span class="in"># NB: if you haven't already installed bcogsci through devtools, it won't be loaded</span></span>
<span id="cb121-42"><a href="#cb121-42" aria-hidden="true" tabindex="-1"></a><span class="in">## Now load or install &amp; load all</span></span>
<span id="cb121-43"><a href="#cb121-43" aria-hidden="true" tabindex="-1"></a><span class="in">package.check &lt;- lapply(</span></span>
<span id="cb121-44"><a href="#cb121-44" aria-hidden="true" tabindex="-1"></a><span class="in">  packages,</span></span>
<span id="cb121-45"><a href="#cb121-45" aria-hidden="true" tabindex="-1"></a><span class="in">  FUN = function(x) {</span></span>
<span id="cb121-46"><a href="#cb121-46" aria-hidden="true" tabindex="-1"></a><span class="in">    if (!require(x, character.only = TRUE)) {</span></span>
<span id="cb121-47"><a href="#cb121-47" aria-hidden="true" tabindex="-1"></a><span class="in">      install.packages(x, dependencies = TRUE)</span></span>
<span id="cb121-48"><a href="#cb121-48" aria-hidden="true" tabindex="-1"></a><span class="in">      library(x, character.only = TRUE)</span></span>
<span id="cb121-49"><a href="#cb121-49" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb121-50"><a href="#cb121-50" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb121-51"><a href="#cb121-51" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb121-52"><a href="#cb121-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-53"><a href="#cb121-53" aria-hidden="true" tabindex="-1"></a><span class="in"># this is also required, taken from the textbook</span></span>
<span id="cb121-54"><a href="#cb121-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-55"><a href="#cb121-55" aria-hidden="true" tabindex="-1"></a><span class="in">## Save compiled models:</span></span>
<span id="cb121-56"><a href="#cb121-56" aria-hidden="true" tabindex="-1"></a><span class="in">rstan_options(auto_write = FALSE)</span></span>
<span id="cb121-57"><a href="#cb121-57" aria-hidden="true" tabindex="-1"></a><span class="in">## Parallelize the chains using all the cores:</span></span>
<span id="cb121-58"><a href="#cb121-58" aria-hidden="true" tabindex="-1"></a><span class="in">options(mc.cores = parallel::detectCores())</span></span>
<span id="cb121-59"><a href="#cb121-59" aria-hidden="true" tabindex="-1"></a><span class="in"># To solve some conflicts between packages</span></span>
<span id="cb121-60"><a href="#cb121-60" aria-hidden="true" tabindex="-1"></a><span class="in">select &lt;- dplyr::select</span></span>
<span id="cb121-61"><a href="#cb121-61" aria-hidden="true" tabindex="-1"></a><span class="in">extract &lt;- rstan::extract</span></span>
<span id="cb121-62"><a href="#cb121-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-63"><a href="#cb121-63" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 5 - Bayesian hierachical models</span></span>
<span id="cb121-64"><a href="#cb121-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-65"><a href="#cb121-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 5.1 A hierarchical model (normal likelihood) of cognitive load on pupil .</span></span>
<span id="cb121-66"><a href="#cb121-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-67"><a href="#cb121-67" aria-hidden="true" tabindex="-1"></a>As in section 4.1, we focus on the effect of cognitive load on pupil , but this time we look at all the subjects of Wahn et al. (2016):</span>
<span id="cb121-68"><a href="#cb121-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-71"><a href="#cb121-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-72"><a href="#cb121-72" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_pupil_complete"</span>)</span>
<span id="cb121-73"><a href="#cb121-73" aria-hidden="true" tabindex="-1"></a>df_pupil_complete</span>
<span id="cb121-74"><a href="#cb121-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-75"><a href="#cb121-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-76"><a href="#cb121-76" aria-hidden="true" tabindex="-1"></a>You should be able to now fit a “maximal” model (correlated varying intercept and slopes for subjects) assuming a normal likelihood. Base your priors in the priors discussed in section 4.1.</span>
<span id="cb121-77"><a href="#cb121-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-78"><a href="#cb121-78" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-79"><a href="#cb121-79" aria-hidden="true" tabindex="-1"></a><span class="fu">### Maximal model</span></span>
<span id="cb121-80"><a href="#cb121-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-81"><a href="#cb121-81" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>first centre the predictor</span>
<span id="cb121-82"><a href="#cb121-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-85"><a href="#cb121-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-86"><a href="#cb121-86" aria-hidden="true" tabindex="-1"></a>df_pupil_complete <span class="ot">&lt;-</span> df_pupil_complete <span class="sc">%&gt;%</span></span>
<span id="cb121-87"><a href="#cb121-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c_load =</span> load<span class="sc">-</span><span class="fu">mean</span>(load))</span>
<span id="cb121-88"><a href="#cb121-88" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-89"><a href="#cb121-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-90"><a href="#cb121-90" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>then run the model</span>
<span id="cb121-91"><a href="#cb121-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-92"><a href="#cb121-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=F, error=T, warning=T}</span></span>
<span id="cb121-93"><a href="#cb121-93" aria-hidden="true" tabindex="-1"></a><span class="in">fit_pupil &lt;- brm(p_size ~ 1 + c_load + </span></span>
<span id="cb121-94"><a href="#cb121-94" aria-hidden="true" tabindex="-1"></a><span class="in">                   (1 +c_load | subj), </span></span>
<span id="cb121-95"><a href="#cb121-95" aria-hidden="true" tabindex="-1"></a><span class="in">                 data = df_pupil_complete,</span></span>
<span id="cb121-96"><a href="#cb121-96" aria-hidden="true" tabindex="-1"></a><span class="in">                 family = gaussian(),</span></span>
<span id="cb121-97"><a href="#cb121-97" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior = c(</span></span>
<span id="cb121-98"><a href="#cb121-98" aria-hidden="true" tabindex="-1"></a><span class="in">                   prior(normal(1000, 500), class = Intercept),</span></span>
<span id="cb121-99"><a href="#cb121-99" aria-hidden="true" tabindex="-1"></a><span class="in">                   prior(normal(0, 1000), class = sigma),</span></span>
<span id="cb121-100"><a href="#cb121-100" aria-hidden="true" tabindex="-1"></a><span class="in">                   prior(normal(0, 100), class = b, coef = c_load),</span></span>
<span id="cb121-101"><a href="#cb121-101" aria-hidden="true" tabindex="-1"></a><span class="in">                   prior(normal(0, 1000), class = sd),</span></span>
<span id="cb121-102"><a href="#cb121-102" aria-hidden="true" tabindex="-1"></a><span class="in">                   prior(lkj(2), class = cor)</span></span>
<span id="cb121-103"><a href="#cb121-103" aria-hidden="true" tabindex="-1"></a><span class="in">                 ),</span></span>
<span id="cb121-104"><a href="#cb121-104" aria-hidden="true" tabindex="-1"></a><span class="in">                 file = here::here("models", "exercises", "ch5", "fit_pupil")</span></span>
<span id="cb121-105"><a href="#cb121-105" aria-hidden="true" tabindex="-1"></a><span class="in">                 )</span></span>
<span id="cb121-106"><a href="#cb121-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-107"><a href="#cb121-107" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-108"><a href="#cb121-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-109"><a href="#cb121-109" aria-hidden="true" tabindex="-1"></a>a. Examine the effect of load on pupil size, and the average pupil size. What do you conclude?</span>
<span id="cb121-110"><a href="#cb121-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-111"><a href="#cb121-111" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-112"><a href="#cb121-112" aria-hidden="true" tabindex="-1"></a><span class="fu">#### My solution</span></span>
<span id="cb121-115"><a href="#cb121-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-116"><a href="#cb121-116" aria-hidden="true" tabindex="-1"></a>fit_pupil</span>
<span id="cb121-117"><a href="#cb121-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-118"><a href="#cb121-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-119"><a href="#cb121-119" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>95% CrI crosses 0: quite a bit of uncertainty</span>
<span id="cb121-120"><a href="#cb121-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-121"><a href="#cb121-121" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>alternatively, to only print <span class="in">`c_load`</span> </span>
<span id="cb121-124"><a href="#cb121-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-125"><a href="#cb121-125" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_pupil, <span class="at">variable =</span> <span class="st">"b_c_load"</span>)</span>
<span id="cb121-126"><a href="#cb121-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-127"><a href="#cb121-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-128"><a href="#cb121-128" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>but the intercept is quite large:</span>
<span id="cb121-131"><a href="#cb121-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-132"><a href="#cb121-132" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_pupil, <span class="at">variable =</span> <span class="st">"b_Intercept"</span>)</span>
<span id="cb121-133"><a href="#cb121-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-134"><a href="#cb121-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-135"><a href="#cb121-135" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>even though we assumed it wouldn't be</span>
<span id="cb121-136"><a href="#cb121-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-139"><a href="#cb121-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-140"><a href="#cb121-140" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">prior_summary</span>(fit_pupil)</span>
<span id="cb121-141"><a href="#cb121-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-142"><a href="#cb121-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-143"><a href="#cb121-143" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>overly informative prior for the intercept?</span>
<span id="cb121-144"><a href="#cb121-144" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-145"><a href="#cb121-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-146"><a href="#cb121-146" aria-hidden="true" tabindex="-1"></a>b. Do a sensitivity analysis for the prior on the intercept ($\alpha$). What is the estimate of the effect ($\beta$) under different priors?</span>
<span id="cb121-147"><a href="#cb121-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-148"><a href="#cb121-148" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-149"><a href="#cb121-149" aria-hidden="true" tabindex="-1"></a><span class="fu">#### My solution</span></span>
<span id="cb121-150"><a href="#cb121-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-151"><a href="#cb121-151" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>try a *wider* prior for $\alpha$; I'm choosing 3000 and 1000ms</span>
<span id="cb121-152"><a href="#cb121-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-153"><a href="#cb121-153" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb121-154"><a href="#cb121-154" aria-hidden="true" tabindex="-1"></a>\alpha \sim Normal(3000,1000)</span>
<span id="cb121-155"><a href="#cb121-155" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb121-156"><a href="#cb121-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-159"><a href="#cb121-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-160"><a href="#cb121-160" aria-hidden="true" tabindex="-1"></a>fit_pupil_2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(p_size <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> c_load <span class="sc">+</span> </span>
<span id="cb121-161"><a href="#cb121-161" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span> <span class="sc">+</span> c_load <span class="sc">|</span> subj), </span>
<span id="cb121-162"><a href="#cb121-162" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_pupil_complete,</span>
<span id="cb121-163"><a href="#cb121-163" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb121-164"><a href="#cb121-164" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb121-165"><a href="#cb121-165" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">3000</span>, <span class="dv">1000</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb121-166"><a href="#cb121-166" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1000</span>), <span class="at">class =</span> sigma),</span>
<span id="cb121-167"><a href="#cb121-167" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">class =</span> b, <span class="at">coef =</span> c_load),</span>
<span id="cb121-168"><a href="#cb121-168" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1000</span>), <span class="at">class =</span> sd),</span>
<span id="cb121-169"><a href="#cb121-169" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)</span>
<span id="cb121-170"><a href="#cb121-170" aria-hidden="true" tabindex="-1"></a>                 ),</span>
<span id="cb121-171"><a href="#cb121-171" aria-hidden="true" tabindex="-1"></a>                 <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_pupil_2"</span>)</span>
<span id="cb121-172"><a href="#cb121-172" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb121-173"><a href="#cb121-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-174"><a href="#cb121-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-177"><a href="#cb121-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-178"><a href="#cb121-178" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_pupil_2, <span class="at">variable =</span> <span class="st">"b_c_load"</span>)</span>
<span id="cb121-179"><a href="#cb121-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-180"><a href="#cb121-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-181"><a href="#cb121-181" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the effect of <span class="in">`c_load`</span> now ha more certainty</span>
<span id="cb121-182"><a href="#cb121-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-185"><a href="#cb121-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-186"><a href="#cb121-186" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_pupil, <span class="at">variable =</span> <span class="st">"b_Intercept"</span>)</span>
<span id="cb121-187"><a href="#cb121-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-188"><a href="#cb121-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-189"><a href="#cb121-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-190"><a href="#cb121-190" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-191"><a href="#cb121-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-192"><a href="#cb121-192" aria-hidden="true" tabindex="-1"></a>c. Is the effect of load consistent across subjects? Investigate this visually.</span>
<span id="cb121-193"><a href="#cb121-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-194"><a href="#cb121-194" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-195"><a href="#cb121-195" aria-hidden="true" tabindex="-1"></a><span class="fu">#### My solution</span></span>
<span id="cb121-196"><a href="#cb121-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-197"><a href="#cb121-197" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>check out overall effect; there are 3 peaks</span>
<span id="cb121-198"><a href="#cb121-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-201"><a href="#cb121-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-202"><a href="#cb121-202" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit_pupil_2, <span class="at">ndraws =</span> <span class="dv">50</span>, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span>
<span id="cb121-203"><a href="#cb121-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-204"><a href="#cb121-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-205"><a href="#cb121-205" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>now by participants</span>
<span id="cb121-206"><a href="#cb121-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-209"><a href="#cb121-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-210"><a href="#cb121-210" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay_grouped</span>(df_pupil_complete<span class="sc">$</span>p_size,</span>
<span id="cb121-211"><a href="#cb121-211" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrep =</span></span>
<span id="cb121-212"><a href="#cb121-212" aria-hidden="true" tabindex="-1"></a>    <span class="fu">posterior_predict</span>(fit_pupil_2,</span>
<span id="cb121-213"><a href="#cb121-213" aria-hidden="true" tabindex="-1"></a>      <span class="at">ndraws =</span> <span class="dv">100</span></span>
<span id="cb121-214"><a href="#cb121-214" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb121-215"><a href="#cb121-215" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> df_pupil_complete<span class="sc">$</span>subj</span>
<span id="cb121-216"><a href="#cb121-216" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb121-217"><a href="#cb121-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Signal in the N400 spatiotemporal window"</span>)</span>
<span id="cb121-218"><a href="#cb121-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-219"><a href="#cb121-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-220"><a href="#cb121-220" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>and by sd</span>
<span id="cb121-221"><a href="#cb121-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-224"><a href="#cb121-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-225"><a href="#cb121-225" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit_pupil_2,</span>
<span id="cb121-226"><a href="#cb121-226" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"stat_grouped"</span>,</span>
<span id="cb121-227"><a href="#cb121-227" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">1000</span>,</span>
<span id="cb121-228"><a href="#cb121-228" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"subj"</span>,</span>
<span id="cb121-229"><a href="#cb121-229" aria-hidden="true" tabindex="-1"></a>  <span class="at">stat =</span> <span class="st">"sd"</span></span>
<span id="cb121-230"><a href="#cb121-230" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-231"><a href="#cb121-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-232"><a href="#cb121-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-233"><a href="#cb121-233" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>and also:</span>
<span id="cb121-234"><a href="#cb121-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-237"><a href="#cb121-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-238"><a href="#cb121-238" aria-hidden="true" tabindex="-1"></a><span class="do">## For the hierarchical model is more complicated, # because we want the effect (beta) + adjustment: # we extract the overall group level effect:</span></span>
<span id="cb121-239"><a href="#cb121-239" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as_draws_df</span>(fit_pupil_2)<span class="sc">$</span>b_c_load)</span>
<span id="cb121-240"><a href="#cb121-240" aria-hidden="true" tabindex="-1"></a><span class="co"># We extract the individual adjustments</span></span>
<span id="cb121-241"><a href="#cb121-241" aria-hidden="true" tabindex="-1"></a>ind_effects_v <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"r_subj["</span>, <span class="fu">unique</span>(df_pupil_complete<span class="sc">$</span>subj), <span class="st">",c_load]"</span>) </span>
<span id="cb121-242"><a href="#cb121-242" aria-hidden="true" tabindex="-1"></a>adjustment <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_draws_df</span>(fit_pupil)[ind_effects_v])</span>
<span id="cb121-243"><a href="#cb121-243" aria-hidden="true" tabindex="-1"></a><span class="co"># We get the by subject effects in a data frame where each adjustment # is in each column.</span></span>
<span id="cb121-244"><a href="#cb121-244" aria-hidden="true" tabindex="-1"></a>by_subj_effect <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(beta <span class="sc">+</span> adjustment)</span>
<span id="cb121-245"><a href="#cb121-245" aria-hidden="true" tabindex="-1"></a><span class="co"># We summarize them by getting a table with the mean and the</span></span>
<span id="cb121-246"><a href="#cb121-246" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles for each column and then binding them.</span></span>
<span id="cb121-247"><a href="#cb121-247" aria-hidden="true" tabindex="-1"></a>par_h <span class="ot">&lt;-</span> <span class="fu">lapply</span>(by_subj_effect, <span class="cf">function</span>(x) {</span>
<span id="cb121-248"><a href="#cb121-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb121-249"><a href="#cb121-249" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> <span class="fu">mean</span>(x),</span>
<span id="cb121-250"><a href="#cb121-250" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q2.5 =</span> <span class="fu">quantile</span>(x, .<span class="dv">025</span>),</span>
<span id="cb121-251"><a href="#cb121-251" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q97.5 =</span> <span class="fu">quantile</span>(x, .<span class="dv">975</span>)</span>
<span id="cb121-252"><a href="#cb121-252" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb121-253"><a href="#cb121-253" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb121-254"><a href="#cb121-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb121-255"><a href="#cb121-255" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We add a column to identify that the model, # and one with the subject labels:</span></span>
<span id="cb121-256"><a href="#cb121-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subj =</span> <span class="fu">unique</span>(df_pupil_complete<span class="sc">$</span>subj)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Estimate) <span class="sc">%&gt;%</span></span>
<span id="cb121-257"><a href="#cb121-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subj =</span> <span class="fu">factor</span>(subj, <span class="at">levels =</span> subj))</span>
<span id="cb121-258"><a href="#cb121-258" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(par_h,</span>
<span id="cb121-259"><a href="#cb121-259" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb121-260"><a href="#cb121-260" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymin =</span> Q2<span class="fl">.5</span>,</span>
<span id="cb121-261"><a href="#cb121-261" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymax =</span> Q97<span class="fl">.5</span>,</span>
<span id="cb121-262"><a href="#cb121-262" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> subj,</span>
<span id="cb121-263"><a href="#cb121-263" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> Estimate</span>
<span id="cb121-264"><a href="#cb121-264" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb121-265"><a href="#cb121-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>() <span class="sc">+</span></span>
<span id="cb121-266"><a href="#cb121-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb121-267"><a href="#cb121-267" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We'll also add the mean and 95% CrI of the overall difference # to the plot:</span></span>
<span id="cb121-268"><a href="#cb121-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span></span>
<span id="cb121-269"><a href="#cb121-269" aria-hidden="true" tabindex="-1"></a>               <span class="fu">posterior_summary</span>(fit_pupil_2)[<span class="st">"b_c_load"</span>, <span class="st">"Estimate"</span>]) <span class="sc">+</span></span>
<span id="cb121-270"><a href="#cb121-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb121-271"><a href="#cb121-271" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span></span>
<span id="cb121-272"><a href="#cb121-272" aria-hidden="true" tabindex="-1"></a>      <span class="fu">posterior_summary</span>(fit_pupil_2)[<span class="st">"b_c_load"</span>, <span class="st">"Q2.5"</span>],</span>
<span id="cb121-273"><a href="#cb121-273" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb121-274"><a href="#cb121-274" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> .<span class="dv">5</span></span>
<span id="cb121-275"><a href="#cb121-275" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">geom_hline</span>(</span>
<span id="cb121-276"><a href="#cb121-276" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span></span>
<span id="cb121-277"><a href="#cb121-277" aria-hidden="true" tabindex="-1"></a>      <span class="fu">posterior_summary</span>(fit_pupil_2)[<span class="st">"b_c_load"</span>, <span class="st">"Q97.5"</span>],</span>
<span id="cb121-278"><a href="#cb121-278" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb121-279"><a href="#cb121-279" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> .<span class="dv">5</span></span>
<span id="cb121-280"><a href="#cb121-280" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb121-281"><a href="#cb121-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb121-282"><a href="#cb121-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Change in pupil size"</span>) <span class="sc">+</span> </span>
<span id="cb121-283"><a href="#cb121-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Participant ID"</span>) <span class="sc">+</span></span>
<span id="cb121-284"><a href="#cb121-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb121-285"><a href="#cb121-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-286"><a href="#cb121-286" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-287"><a href="#cb121-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-288"><a href="#cb121-288" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 5.2 Are subject relatives easier to process than object relatives (log-normal likelihood)?</span></span>
<span id="cb121-289"><a href="#cb121-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-290"><a href="#cb121-290" aria-hidden="true" tabindex="-1"></a>We begin with a classic question from the psycholinguistics literature: Are subject relatives easier to process than object relatives? The data come from Experiment 1 in a paper by Grodner and Gibson (2005).</span>
<span id="cb121-291"><a href="#cb121-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-292"><a href="#cb121-292" aria-hidden="true" tabindex="-1"></a>Scientific question: Is there a subject relative advantage in reading?</span>
<span id="cb121-293"><a href="#cb121-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-294"><a href="#cb121-294" aria-hidden="true" tabindex="-1"></a>Grodner and Gibson (2005) investigate an old claim in psycholinguistics that object relative clause (ORC) sentences are more difficult to process than subject relative clause (SRC) sentences. One explanation for this predicted difference is that the distance between the relative clause verb (sent in the example below) and the head noun phrase of the relative clause (reporter in the example below) is longer in ORC vs. SRC. Examples are shown below. The relative clause is shown in square brackets.</span>
<span id="cb121-295"><a href="#cb121-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-296"><a href="#cb121-296" aria-hidden="true" tabindex="-1"></a>(1a) The reporter <span class="co">[</span><span class="ot">who the photographer sent to the editor</span><span class="co">]</span> was hoping for a good story. (ORC)</span>
<span id="cb121-297"><a href="#cb121-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-298"><a href="#cb121-298" aria-hidden="true" tabindex="-1"></a>(1b) The reporter <span class="co">[</span><span class="ot">who sent the photographer to the editor</span><span class="co">]</span> was hoping for a good story. (SRC)</span>
<span id="cb121-299"><a href="#cb121-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-300"><a href="#cb121-300" aria-hidden="true" tabindex="-1"></a>The underlying explanation has to do with memory processes: Shorter linguistic dependencies are easier to process due to either reduced interference or decay, or both. For implemented computational models that spell this point out, see Lewis and Vasishth (2005) and Engelmann, Jäger, and Vasishth (2020).</span>
<span id="cb121-301"><a href="#cb121-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-302"><a href="#cb121-302" aria-hidden="true" tabindex="-1"></a>In the Grodner and Gibson data, the dependent measure is reading time at the relative clause verb, (e.g., sent) of different sentences with either ORC or SRC. The dependent variable is in milliseconds and was measured in a self-paced reading task. Self-paced reading is a task where subjects read a sentence or a short text word-by-word or phrase-by-phrase, pressing a button to get each word or phrase displayed; the preceding word disappears every time the button is pressed. In 6.1, we provide a more detailed explanation of this experimental method.</span>
<span id="cb121-303"><a href="#cb121-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-304"><a href="#cb121-304" aria-hidden="true" tabindex="-1"></a>For this experiment, we are expecting longer reading times at the relative clause verbs of ORC sentences in comparison to the relative clause verb of SRC sentences.</span>
<span id="cb121-305"><a href="#cb121-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-308"><a href="#cb121-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-309"><a href="#cb121-309" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_gg05_rc"</span>)</span>
<span id="cb121-310"><a href="#cb121-310" aria-hidden="true" tabindex="-1"></a>df_gg05_rc</span>
<span id="cb121-311"><a href="#cb121-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-312"><a href="#cb121-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-313"><a href="#cb121-313" aria-hidden="true" tabindex="-1"></a>You should use a sum coding for the predictors. Here, object relative clauses ("objgaps") are coded +1, subject relative clauses -1.</span>
<span id="cb121-314"><a href="#cb121-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-315"><a href="#cb121-315" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-316"><a href="#cb121-316" aria-hidden="true" tabindex="-1"></a><span class="fu"># Set contrasts</span></span>
<span id="cb121-319"><a href="#cb121-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-320"><a href="#cb121-320" aria-hidden="true" tabindex="-1"></a>df_gg05_rc<span class="sc">$</span>condition <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_gg05_rc<span class="sc">$</span>condition, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"subjgap"</span>,<span class="st">"objgap"</span>))</span>
<span id="cb121-321"><a href="#cb121-321" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df_gg05_rc<span class="sc">$</span>condition)</span>
<span id="cb121-322"><a href="#cb121-322" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gg05_rc<span class="sc">$</span>condition) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">5</span>,<span class="sc">+</span>.<span class="dv">5</span>)</span>
<span id="cb121-323"><a href="#cb121-323" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gg05_rc<span class="sc">$</span>condition)</span>
<span id="cb121-324"><a href="#cb121-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-325"><a href="#cb121-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-326"><a href="#cb121-326" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>or, as in the book:</span>
<span id="cb121-327"><a href="#cb121-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-330"><a href="#cb121-330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-331"><a href="#cb121-331" aria-hidden="true" tabindex="-1"></a>df_gg05_rc <span class="ot">&lt;-</span> df_gg05_rc <span class="sc">%&gt;%</span></span>
<span id="cb121-332"><a href="#cb121-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c_cond =</span> <span class="fu">if_else</span>(condition <span class="sc">==</span> <span class="st">"objgap"</span>, .<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>))</span>
<span id="cb121-333"><a href="#cb121-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-334"><a href="#cb121-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-335"><a href="#cb121-335" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-336"><a href="#cb121-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-337"><a href="#cb121-337" aria-hidden="true" tabindex="-1"></a>You should be able to now fit a “maximal” model (correlated varying intercept and slopes for subjects and for items) assuming a log-normal likelihood.</span>
<span id="cb121-338"><a href="#cb121-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-339"><a href="#cb121-339" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-340"><a href="#cb121-340" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Maximal model</span></span>
<span id="cb121-341"><a href="#cb121-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-344"><a href="#cb121-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-345"><a href="#cb121-345" aria-hidden="true" tabindex="-1"></a>fit_df_gg05_rc <span class="ot">&lt;-</span></span>
<span id="cb121-346"><a href="#cb121-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<span id="cb121-347"><a href="#cb121-347" aria-hidden="true" tabindex="-1"></a>    RT <span class="sc">~</span> condition <span class="sc">+</span> (condition <span class="sc">|</span></span>
<span id="cb121-348"><a href="#cb121-348" aria-hidden="true" tabindex="-1"></a>                     subj) <span class="sc">+</span> (condition <span class="sc">|</span> item),</span>
<span id="cb121-349"><a href="#cb121-349" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb121-350"><a href="#cb121-350" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span></span>
<span id="cb121-351"><a href="#cb121-351" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb121-352"><a href="#cb121-352" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">6</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb121-353"><a href="#cb121-353" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, .<span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb121-354"><a href="#cb121-354" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb121-355"><a href="#cb121-355" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb121-356"><a href="#cb121-356" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)</span>
<span id="cb121-357"><a href="#cb121-357" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb121-358"><a href="#cb121-358" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_gg05_rc,</span>
<span id="cb121-359"><a href="#cb121-359" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_df_gg05_rc"</span>)</span>
<span id="cb121-360"><a href="#cb121-360" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb121-361"><a href="#cb121-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-362"><a href="#cb121-362" aria-hidden="true" tabindex="-1"></a>fit_df_gg05_rc</span>
<span id="cb121-363"><a href="#cb121-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-364"><a href="#cb121-364" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-365"><a href="#cb121-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-366"><a href="#cb121-366" aria-hidden="true" tabindex="-1"></a>a. Examine the effect of relative clause attachment site (the predictor <span class="in">`c_cond`</span>) on reading times RT ($\beta$).</span>
<span id="cb121-367"><a href="#cb121-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-368"><a href="#cb121-368" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-369"><a href="#cb121-369" aria-hidden="true" tabindex="-1"></a><span class="fu">##### My solution</span></span>
<span id="cb121-370"><a href="#cb121-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-371"><a href="#cb121-371" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the effect of RC attachment on RT on the log scale is </span>
<span id="cb121-372"><a href="#cb121-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-375"><a href="#cb121-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-376"><a href="#cb121-376" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_df_gg05_rc, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)</span>
<span id="cb121-377"><a href="#cb121-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-378"><a href="#cb121-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-379"><a href="#cb121-379" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-380"><a href="#cb121-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-381"><a href="#cb121-381" aria-hidden="true" tabindex="-1"></a>b. Estimate the median difference between relative clause attachment sites in milliseconds, and report the mean and 95% CI.</span>
<span id="cb121-382"><a href="#cb121-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-383"><a href="#cb121-383" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-384"><a href="#cb121-384" aria-hidden="true" tabindex="-1"></a><span class="fu">##### My solution</span></span>
<span id="cb121-385"><a href="#cb121-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-388"><a href="#cb121-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-389"><a href="#cb121-389" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc)<span class="sc">$</span>b_Intercept</span>
<span id="cb121-390"><a href="#cb121-390" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc)<span class="sc">$</span>b_condition1</span>
<span id="cb121-391"><a href="#cb121-391" aria-hidden="true" tabindex="-1"></a><span class="co"># Difference between object RC coded as .5 and subject RC coded as .5 </span></span>
<span id="cb121-392"><a href="#cb121-392" aria-hidden="true" tabindex="-1"></a>effect <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha <span class="sc">+</span> beta <span class="sc">*</span> .<span class="dv">5</span>) <span class="sc">-</span> <span class="fu">exp</span>(alpha <span class="sc">+</span> beta <span class="sc">*</span> <span class="sc">-</span>.<span class="dv">5</span>)</span>
<span id="cb121-393"><a href="#cb121-393" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">mean =</span> <span class="fu">mean</span>(effect), <span class="fu">quantile</span>(effect, <span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>)))</span>
<span id="cb121-394"><a href="#cb121-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-395"><a href="#cb121-395" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-396"><a href="#cb121-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-397"><a href="#cb121-397" aria-hidden="true" tabindex="-1"></a>c. Do a sensitivity analysis. What is the estimate of the effect ($\beta$) under different priors? What is the difference in milliseconds between conditions under different priors?</span>
<span id="cb121-398"><a href="#cb121-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-399"><a href="#cb121-399" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-400"><a href="#cb121-400" aria-hidden="true" tabindex="-1"></a><span class="fu">##### My solution</span></span>
<span id="cb121-401"><a href="#cb121-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-402"><a href="#cb121-402" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>first let's check out the fit of the model</span>
<span id="cb121-403"><a href="#cb121-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-406"><a href="#cb121-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-407"><a href="#cb121-407" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit_df_gg05_rc, <span class="at">ndraws =</span> <span class="dv">50</span>, <span class="at">type =</span> <span class="st">"dens_overlay"</span>)</span>
<span id="cb121-408"><a href="#cb121-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-409"><a href="#cb121-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-410"><a href="#cb121-410" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>now by participants</span>
<span id="cb121-411"><a href="#cb121-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-414"><a href="#cb121-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-415"><a href="#cb121-415" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay_grouped</span>(df_gg05_rc<span class="sc">$</span>RT,</span>
<span id="cb121-416"><a href="#cb121-416" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrep =</span></span>
<span id="cb121-417"><a href="#cb121-417" aria-hidden="true" tabindex="-1"></a>    <span class="fu">posterior_predict</span>(fit_df_gg05_rc,</span>
<span id="cb121-418"><a href="#cb121-418" aria-hidden="true" tabindex="-1"></a>      <span class="at">ndraws =</span> <span class="dv">100</span></span>
<span id="cb121-419"><a href="#cb121-419" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb121-420"><a href="#cb121-420" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> df_gg05_rc<span class="sc">$</span>subj</span>
<span id="cb121-421"><a href="#cb121-421" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb121-422"><a href="#cb121-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Signal in the N400 spatiotemporal window"</span>)</span>
<span id="cb121-423"><a href="#cb121-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-424"><a href="#cb121-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-425"><a href="#cb121-425" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>and by sd</span>
<span id="cb121-426"><a href="#cb121-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-429"><a href="#cb121-429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-430"><a href="#cb121-430" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit_df_gg05_rc,</span>
<span id="cb121-431"><a href="#cb121-431" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"stat_grouped"</span>,</span>
<span id="cb121-432"><a href="#cb121-432" aria-hidden="true" tabindex="-1"></a>  <span class="at">ndraws =</span> <span class="dv">1000</span>,</span>
<span id="cb121-433"><a href="#cb121-433" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"subj"</span>,</span>
<span id="cb121-434"><a href="#cb121-434" aria-hidden="true" tabindex="-1"></a>  <span class="at">stat =</span> <span class="st">"sd"</span></span>
<span id="cb121-435"><a href="#cb121-435" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-436"><a href="#cb121-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-437"><a href="#cb121-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-440"><a href="#cb121-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-441"><a href="#cb121-441" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_df_gg05_rc, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)</span>
<span id="cb121-442"><a href="#cb121-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-443"><a href="#cb121-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-446"><a href="#cb121-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-447"><a href="#cb121-447" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_df_gg05_rc, <span class="at">variable =</span> <span class="st">"b_Intercept"</span>)</span>
<span id="cb121-448"><a href="#cb121-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-449"><a href="#cb121-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-450"><a href="#cb121-450" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>our posteriors are pretty close to our priors</span>
<span id="cb121-451"><a href="#cb121-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-454"><a href="#cb121-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-455"><a href="#cb121-455" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">prior_summary</span>(fit_df_gg05_rc)</span>
<span id="cb121-456"><a href="#cb121-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-457"><a href="#cb121-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-458"><a href="#cb121-458" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>let's see if this is due to the influence of our priors. Let's start with *narrower* prior</span>
<span id="cb121-459"><a href="#cb121-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-460"><a href="#cb121-460" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb121-461"><a href="#cb121-461" aria-hidden="true" tabindex="-1"></a>\beta \sim Normal(0,.01)</span>
<span id="cb121-462"><a href="#cb121-462" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb121-463"><a href="#cb121-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-466"><a href="#cb121-466" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-467"><a href="#cb121-467" aria-hidden="true" tabindex="-1"></a>fit_df_gg05_rc_tight <span class="ot">&lt;-</span></span>
<span id="cb121-468"><a href="#cb121-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<span id="cb121-469"><a href="#cb121-469" aria-hidden="true" tabindex="-1"></a>    RT <span class="sc">~</span> condition <span class="sc">+</span> (condition <span class="sc">|</span></span>
<span id="cb121-470"><a href="#cb121-470" aria-hidden="true" tabindex="-1"></a>                     subj) <span class="sc">+</span> (condition <span class="sc">|</span> item),</span>
<span id="cb121-471"><a href="#cb121-471" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb121-472"><a href="#cb121-472" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span></span>
<span id="cb121-473"><a href="#cb121-473" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb121-474"><a href="#cb121-474" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">6</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb121-475"><a href="#cb121-475" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, .<span class="dv">01</span>), <span class="at">class =</span> b),</span>
<span id="cb121-476"><a href="#cb121-476" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb121-477"><a href="#cb121-477" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb121-478"><a href="#cb121-478" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)</span>
<span id="cb121-479"><a href="#cb121-479" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb121-480"><a href="#cb121-480" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_gg05_rc,</span>
<span id="cb121-481"><a href="#cb121-481" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_df_gg05_rc_tight"</span>)</span>
<span id="cb121-482"><a href="#cb121-482" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb121-483"><a href="#cb121-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-484"><a href="#cb121-484" aria-hidden="true" tabindex="-1"></a>fit_df_gg05_rc_tight</span>
<span id="cb121-485"><a href="#cb121-485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-486"><a href="#cb121-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-489"><a href="#cb121-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-490"><a href="#cb121-490" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_df_gg05_rc_tight, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)</span>
<span id="cb121-491"><a href="#cb121-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-492"><a href="#cb121-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-493"><a href="#cb121-493" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>and now a *wider* prior</span>
<span id="cb121-494"><a href="#cb121-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-495"><a href="#cb121-495" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb121-496"><a href="#cb121-496" aria-hidden="true" tabindex="-1"></a>\beta \sim Normal(0,1)</span>
<span id="cb121-497"><a href="#cb121-497" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb121-498"><a href="#cb121-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-501"><a href="#cb121-501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-502"><a href="#cb121-502" aria-hidden="true" tabindex="-1"></a>fit_df_gg05_rc_wide <span class="ot">&lt;-</span></span>
<span id="cb121-503"><a href="#cb121-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<span id="cb121-504"><a href="#cb121-504" aria-hidden="true" tabindex="-1"></a>    RT <span class="sc">~</span> condition <span class="sc">+</span> (condition <span class="sc">|</span></span>
<span id="cb121-505"><a href="#cb121-505" aria-hidden="true" tabindex="-1"></a>                     subj) <span class="sc">+</span> (condition <span class="sc">|</span> item),</span>
<span id="cb121-506"><a href="#cb121-506" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">lognormal</span>(),</span>
<span id="cb121-507"><a href="#cb121-507" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span></span>
<span id="cb121-508"><a href="#cb121-508" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb121-509"><a href="#cb121-509" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">6</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb121-510"><a href="#cb121-510" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb121-511"><a href="#cb121-511" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb121-512"><a href="#cb121-512" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb121-513"><a href="#cb121-513" aria-hidden="true" tabindex="-1"></a>        <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)</span>
<span id="cb121-514"><a href="#cb121-514" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb121-515"><a href="#cb121-515" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_gg05_rc,</span>
<span id="cb121-516"><a href="#cb121-516" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"models"</span>, <span class="st">"exercises"</span>, <span class="st">"ch5"</span>, <span class="st">"fit_df_gg05_rc_wide"</span>)</span>
<span id="cb121-517"><a href="#cb121-517" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb121-518"><a href="#cb121-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-519"><a href="#cb121-519" aria-hidden="true" tabindex="-1"></a>fit_df_gg05_rc_wide</span>
<span id="cb121-520"><a href="#cb121-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-521"><a href="#cb121-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-524"><a href="#cb121-524" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-525"><a href="#cb121-525" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(fit_df_gg05_rc_wide, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)</span>
<span id="cb121-526"><a href="#cb121-526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-527"><a href="#cb121-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-530"><a href="#cb121-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-531"><a href="#cb121-531" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">posterior_summary</span>(fit_df_gg05_rc, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb121-532"><a href="#cb121-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Prior for $</span><span class="sc">\\</span><span class="st">beta$"</span> <span class="ot">=</span> <span class="st">"Normal(0,.1)"</span>)</span>
<span id="cb121-533"><a href="#cb121-533" aria-hidden="true" tabindex="-1"></a>tight <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">posterior_summary</span>(fit_df_gg05_rc_tight, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb121-534"><a href="#cb121-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Prior for $</span><span class="sc">\\</span><span class="st">beta$"</span> <span class="ot">=</span> <span class="st">"Normal(0,.01)"</span>)</span>
<span id="cb121-535"><a href="#cb121-535" aria-hidden="true" tabindex="-1"></a>wide <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">posterior_summary</span>(fit_df_gg05_rc_wide, <span class="at">variable =</span> <span class="st">"b_condition1"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb121-536"><a href="#cb121-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Prior for $</span><span class="sc">\\</span><span class="st">beta$"</span> <span class="ot">=</span> <span class="st">"Normal(0,1)"</span>)</span>
<span id="cb121-537"><a href="#cb121-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-538"><a href="#cb121-538" aria-hidden="true" tabindex="-1"></a>sens_priors <span class="ot">&lt;-</span> <span class="fu">rbind</span>(prior,tight,wide)</span>
<span id="cb121-539"><a href="#cb121-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-540"><a href="#cb121-540" aria-hidden="true" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">prior_summary</span>(fit_df_gg05_rc_wide)</span>
<span id="cb121-541"><a href="#cb121-541" aria-hidden="true" tabindex="-1"></a>sens_priors <span class="sc">%&gt;%</span> </span>
<span id="cb121-542"><a href="#cb121-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb121-543"><a href="#cb121-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb121-544"><a href="#cb121-544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-545"><a href="#cb121-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-546"><a href="#cb121-546" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>and now in milliseconds</span>
<span id="cb121-547"><a href="#cb121-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-550"><a href="#cb121-550" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-551"><a href="#cb121-551" aria-hidden="true" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc)<span class="sc">$</span>b_Intercept </span>
<span id="cb121-552"><a href="#cb121-552" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc)<span class="sc">$</span>b_condition1</span>
<span id="cb121-553"><a href="#cb121-553" aria-hidden="true" tabindex="-1"></a>diff1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha1 <span class="sc">+</span> beta1<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">exp</span>(alpha1 <span class="sc">-</span> beta1<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb121-554"><a href="#cb121-554" aria-hidden="true" tabindex="-1"></a>prior_ms <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mean =</span> <span class="fu">mean</span>(diff1), <span class="fu">quantile</span>(diff1, .<span class="dv">025</span>), <span class="fu">quantile</span>(diff1, .<span class="dv">975</span>), <span class="at">row.names =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb121-555"><a href="#cb121-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Estimate (ms)"</span> <span class="ot">=</span> <span class="st">"mean"</span>,</span>
<span id="cb121-556"><a href="#cb121-556" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2.5%"</span> <span class="ot">=</span> <span class="st">"quantile.diff1..0.025."</span>,</span>
<span id="cb121-557"><a href="#cb121-557" aria-hidden="true" tabindex="-1"></a>         <span class="st">"97.5%"</span> <span class="ot">=</span> <span class="st">"quantile.diff1..0.975."</span>)<span class="sc">%&gt;%</span></span>
<span id="cb121-558"><a href="#cb121-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Prior for $</span><span class="sc">\\</span><span class="st">beta$"</span> <span class="ot">=</span> <span class="st">"Normal(0,.1)"</span>)</span>
<span id="cb121-559"><a href="#cb121-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-560"><a href="#cb121-560" aria-hidden="true" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc_tight)<span class="sc">$</span>b_Intercept </span>
<span id="cb121-561"><a href="#cb121-561" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc_tight)<span class="sc">$</span>b_condition1</span>
<span id="cb121-562"><a href="#cb121-562" aria-hidden="true" tabindex="-1"></a>diff1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha1 <span class="sc">+</span> beta1<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">exp</span>(alpha1 <span class="sc">-</span> beta1<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb121-563"><a href="#cb121-563" aria-hidden="true" tabindex="-1"></a>tight_ms <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mean =</span> <span class="fu">mean</span>(diff1), <span class="fu">quantile</span>(diff1, .<span class="dv">025</span>), <span class="fu">quantile</span>(diff1, .<span class="dv">975</span>), <span class="at">row.names =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb121-564"><a href="#cb121-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Estimate (ms)"</span> <span class="ot">=</span> <span class="st">"mean"</span>,</span>
<span id="cb121-565"><a href="#cb121-565" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2.5%"</span> <span class="ot">=</span> <span class="st">"quantile.diff1..0.025."</span>,</span>
<span id="cb121-566"><a href="#cb121-566" aria-hidden="true" tabindex="-1"></a>         <span class="st">"97.5%"</span> <span class="ot">=</span> <span class="st">"quantile.diff1..0.975."</span>)<span class="sc">%&gt;%</span></span>
<span id="cb121-567"><a href="#cb121-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Prior for $</span><span class="sc">\\</span><span class="st">beta$"</span> <span class="ot">=</span> <span class="st">"Normal(0,.01)"</span>)</span>
<span id="cb121-568"><a href="#cb121-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-569"><a href="#cb121-569" aria-hidden="true" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc_wide)<span class="sc">$</span>b_Intercept </span>
<span id="cb121-570"><a href="#cb121-570" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_df_gg05_rc_wide)<span class="sc">$</span>b_condition1</span>
<span id="cb121-571"><a href="#cb121-571" aria-hidden="true" tabindex="-1"></a>diff1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha1 <span class="sc">+</span> beta1<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">exp</span>(alpha1 <span class="sc">-</span> beta1<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb121-572"><a href="#cb121-572" aria-hidden="true" tabindex="-1"></a>wide_ms <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mean =</span> <span class="fu">mean</span>(diff1), <span class="fu">quantile</span>(diff1, .<span class="dv">025</span>), <span class="fu">quantile</span>(diff1, .<span class="dv">975</span>), <span class="at">row.names =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb121-573"><a href="#cb121-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Estimate (ms)"</span> <span class="ot">=</span> <span class="st">"mean"</span>,</span>
<span id="cb121-574"><a href="#cb121-574" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2.5%"</span> <span class="ot">=</span> <span class="st">"quantile.diff1..0.025."</span>,</span>
<span id="cb121-575"><a href="#cb121-575" aria-hidden="true" tabindex="-1"></a>         <span class="st">"97.5%"</span> <span class="ot">=</span> <span class="st">"quantile.diff1..0.975."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb121-576"><a href="#cb121-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Prior for $</span><span class="sc">\\</span><span class="st">beta$"</span> <span class="ot">=</span> <span class="st">"Normal(0,1)"</span>)</span>
<span id="cb121-577"><a href="#cb121-577" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-578"><a href="#cb121-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-579"><a href="#cb121-579" aria-hidden="true" tabindex="-1"></a>priors_ms <span class="ot">&lt;-</span> <span class="fu">rbind</span>(prior_ms,tight_ms,wide_ms) <span class="sc">%&gt;%</span></span>
<span id="cb121-580"><a href="#cb121-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effect =</span> <span class="st">"b_condition1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb121-581"><a href="#cb121-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(effect, <span class="at">.before=</span><span class="st">"Estimate (ms)"</span>)</span>
<span id="cb121-582"><a href="#cb121-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-583"><a href="#cb121-583" aria-hidden="true" tabindex="-1"></a>priors_ms <span class="sc">%&gt;%</span> </span>
<span id="cb121-584"><a href="#cb121-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb121-585"><a href="#cb121-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb121-586"><a href="#cb121-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-587"><a href="#cb121-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-588"><a href="#cb121-588" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>we see lots of variation in estimates as a function of our priors</span>
<span id="cb121-589"><a href="#cb121-589" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>with the tight priors, there is a lot more uncertainty</span>
<span id="cb121-590"><a href="#cb121-590" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>with the regularised and wider priors the effects are a bit more similar</span>
<span id="cb121-591"><a href="#cb121-591" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-594"><a href="#cb121-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-595"><a href="#cb121-595" aria-hidden="true" tabindex="-1"></a><span class="co"># these are all the intercept, i'm interested in the slope though :/</span></span>
<span id="cb121-596"><a href="#cb121-596" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb121-597"><a href="#cb121-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pp_check</span>(fit_df_gg05_rc_wide, <span class="at">type =</span> <span class="st">"stat"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Wide priors N(0,1)"</span>),</span>
<span id="cb121-598"><a href="#cb121-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pp_check</span>(fit_df_gg05_rc_tight, <span class="at">type =</span> <span class="st">"stat"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Tight priors N(0,.01)"</span>),</span>
<span id="cb121-599"><a href="#cb121-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pp_check</span>(fit_df_gg05_rc, <span class="at">type =</span> <span class="st">"stat"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Original priors N(0,.1)"</span>),</span>
<span id="cb121-600"><a href="#cb121-600" aria-hidden="true" tabindex="-1"></a><span class="at">nrow =</span> <span class="dv">3</span></span>
<span id="cb121-601"><a href="#cb121-601" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-602"><a href="#cb121-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-603"><a href="#cb121-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-604"><a href="#cb121-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-605"><a href="#cb121-605" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-606"><a href="#cb121-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-607"><a href="#cb121-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-608"><a href="#cb121-608" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 5.3 Relative clause processing in Mandarin Chinese</span></span>
<span id="cb121-609"><a href="#cb121-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-610"><a href="#cb121-610" aria-hidden="true" tabindex="-1"></a>Load the following two data sets:</span>
<span id="cb121-611"><a href="#cb121-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-614"><a href="#cb121-614" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-615"><a href="#cb121-615" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_gibsonwu"</span>)</span>
<span id="cb121-616"><a href="#cb121-616" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_gibsonwu2"</span>)</span>
<span id="cb121-617"><a href="#cb121-617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-618"><a href="#cb121-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-619"><a href="#cb121-619" aria-hidden="true" tabindex="-1"></a>The data are taken from two experiments that investigate (inter alia) the effect of relative clause type on reading time in Chinese. The data are from Gibson and Wu (2013) and Vasishth et al. (2013) respectively. The second data set is a direct replication attempt of the Gibson and Wu (2013) experiment.</span>
<span id="cb121-620"><a href="#cb121-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-621"><a href="#cb121-621" aria-hidden="true" tabindex="-1"></a>Chinese relative clauses are interesting theoretically because they are prenominal: the relative clause appears before the head noun. For example, the English relative clauses shown above would appear in the following order in Mandarin. The square brackets mark the relative clause, and REL refers to the Chinese equivalent of the English relative pronoun who.</span>
<span id="cb121-622"><a href="#cb121-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-623"><a href="#cb121-623" aria-hidden="true" tabindex="-1"></a>(2a) <span class="co">[</span><span class="ot">The photographer sent to the editor</span><span class="co">]</span> REL the reporter was hoping for a good story. (ORC)</span>
<span id="cb121-624"><a href="#cb121-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-625"><a href="#cb121-625" aria-hidden="true" tabindex="-1"></a>(2b) <span class="co">[</span><span class="ot">sent the photographer to the editor</span><span class="co">]</span> REL the reporter who was hoping for a good story. (SRC)</span>
<span id="cb121-626"><a href="#cb121-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-627"><a href="#cb121-627" aria-hidden="true" tabindex="-1"></a>As discussed in Gibson and Wu (2013), the consequence of Chinese relative clauses being prenominal is that the distance between the verb in relative clause and the head noun is larger in subject relatives than object relatives. Hsiao and Gibson (2003) were the first to suggest that the larger distance in subject relatives leads to longer reading time at the head noun. Under this view, the prediction is that subject relatives are harder to process than object relatives. If this is true, this is interesting and surprising because in most other languages that have been studied, subject relatives are easier to process than object relatives; so Chinese will be a very unusual exception cross-linguistically.</span>
<span id="cb121-628"><a href="#cb121-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-629"><a href="#cb121-629" aria-hidden="true" tabindex="-1"></a>The data provided are for the critical region (the head noun; here, reporter). The experiment method is self-paced reading, so we have reading times in milliseconds. The second data set is a direct replication attempt of the first data set, which is from Gibson and Wu (2013).</span>
<span id="cb121-630"><a href="#cb121-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-631"><a href="#cb121-631" aria-hidden="true" tabindex="-1"></a>The research hypothesis is whether the difference in reading times between object and subject relative clauses is negative. For the first data set (<span class="in">`df_gibsonwu`</span>), investigate this question by fitting two “maximal” hierarchical models (correlated varying intercept and slopes for subjects and items). The dependent variable in both models is the raw reading time in milliseconds. The first model should use the normal likelihood in the model; the second model should use the log-normal likelihood. In both models, use $\pm 0.5$ sum coding to model the effect of relative clause type. You will need to decide on appropriate priors for the various parameters.</span>
<span id="cb121-632"><a href="#cb121-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-633"><a href="#cb121-633" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-634"><a href="#cb121-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-635"><a href="#cb121-635" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Contrasts</span></span>
<span id="cb121-636"><a href="#cb121-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-637"><a href="#cb121-637" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`obj-ext = -0.5`</span>, <span class="in">`subj-ext = 0.5`</span></span>
<span id="cb121-638"><a href="#cb121-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-641"><a href="#cb121-641" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-642"><a href="#cb121-642" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_gibsonwu)</span>
<span id="cb121-643"><a href="#cb121-643" aria-hidden="true" tabindex="-1"></a>df_gibsonwu<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_gibsonwu<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"obj-ext"</span>,<span class="st">"subj-ext"</span>))</span>
<span id="cb121-644"><a href="#cb121-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-645"><a href="#cb121-645" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gibsonwu<span class="sc">$</span>type) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb121-646"><a href="#cb121-646" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gibsonwu<span class="sc">$</span>type)</span>
<span id="cb121-647"><a href="#cb121-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-648"><a href="#cb121-648" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb121-649"><a href="#cb121-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-650"><a href="#cb121-650" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-651"><a href="#cb121-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-652"><a href="#cb121-652" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Normal likelihood</span></span>
<span id="cb121-653"><a href="#cb121-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-654"><a href="#cb121-654" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>first set priors</span>
<span id="cb121-655"><a href="#cb121-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-658"><a href="#cb121-658" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-659"><a href="#cb121-659" aria-hidden="true" tabindex="-1"></a>priors_gw_norm <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb121-660"><a href="#cb121-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(500, 150)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb121-661"><a href="#cb121-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,500)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"type1"</span>),</span>
<span id="cb121-662"><a href="#cb121-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,500)"</span>, <span class="at">class =</span> <span class="st">"sd"</span>),</span>
<span id="cb121-663"><a href="#cb121-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1000)"</span>,<span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb121-664"><a href="#cb121-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"lkj(2)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>)</span>
<span id="cb121-665"><a href="#cb121-665" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-666"><a href="#cb121-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-667"><a href="#cb121-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-668"><a href="#cb121-668" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>fit model</span>
<span id="cb121-669"><a href="#cb121-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-670"><a href="#cb121-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = F, error=TRUE, warning=TRUE}</span></span>
<span id="cb121-671"><a href="#cb121-671" aria-hidden="true" tabindex="-1"></a><span class="in">fit_gw_norm &lt;- brm(rt ~ 1 + type + </span></span>
<span id="cb121-672"><a href="#cb121-672" aria-hidden="true" tabindex="-1"></a><span class="in">                   (1 + type | subj) +</span></span>
<span id="cb121-673"><a href="#cb121-673" aria-hidden="true" tabindex="-1"></a><span class="in">                   (1 + type | item), </span></span>
<span id="cb121-674"><a href="#cb121-674" aria-hidden="true" tabindex="-1"></a><span class="in">                 data = df_gibsonwu,</span></span>
<span id="cb121-675"><a href="#cb121-675" aria-hidden="true" tabindex="-1"></a><span class="in">                 family = gaussian(),</span></span>
<span id="cb121-676"><a href="#cb121-676" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior = priors_gw_norm,</span></span>
<span id="cb121-677"><a href="#cb121-677" aria-hidden="true" tabindex="-1"></a><span class="in">                 file = here::here("models", "exercises", "ch5", "fit_gw_norm"))</span></span>
<span id="cb121-678"><a href="#cb121-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-679"><a href="#cb121-679" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-680"><a href="#cb121-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-681"><a href="#cb121-681" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-682"><a href="#cb121-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-683"><a href="#cb121-683" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Log-normal likelihood</span></span>
<span id="cb121-684"><a href="#cb121-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-685"><a href="#cb121-685" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>set priors</span>
<span id="cb121-686"><a href="#cb121-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-689"><a href="#cb121-689" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-690"><a href="#cb121-690" aria-hidden="true" tabindex="-1"></a>priors_gw_log <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb121-691"><a href="#cb121-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(6, 1.5)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb121-692"><a href="#cb121-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"type1"</span>),</span>
<span id="cb121-693"><a href="#cb121-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sd"</span>),</span>
<span id="cb121-694"><a href="#cb121-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb121-695"><a href="#cb121-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"lkj(2)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>)</span>
<span id="cb121-696"><a href="#cb121-696" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-697"><a href="#cb121-697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-698"><a href="#cb121-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-699"><a href="#cb121-699" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>fit model</span>
<span id="cb121-700"><a href="#cb121-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-701"><a href="#cb121-701" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = F, error=TRUE, warning=TRUE}</span></span>
<span id="cb121-702"><a href="#cb121-702" aria-hidden="true" tabindex="-1"></a><span class="in">fit_gw_log &lt;- brm(rt ~ 1 + type + </span></span>
<span id="cb121-703"><a href="#cb121-703" aria-hidden="true" tabindex="-1"></a><span class="in">                   (1 + type | subj) +</span></span>
<span id="cb121-704"><a href="#cb121-704" aria-hidden="true" tabindex="-1"></a><span class="in">                   (1 + type | item), </span></span>
<span id="cb121-705"><a href="#cb121-705" aria-hidden="true" tabindex="-1"></a><span class="in">                 data = df_gibsonwu,</span></span>
<span id="cb121-706"><a href="#cb121-706" aria-hidden="true" tabindex="-1"></a><span class="in">                 family = lognormal(),</span></span>
<span id="cb121-707"><a href="#cb121-707" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior = priors_gw_log,</span></span>
<span id="cb121-708"><a href="#cb121-708" aria-hidden="true" tabindex="-1"></a><span class="in">                 file = here::here("models", "exercises", "ch5", "fit_gw_log")</span></span>
<span id="cb121-709"><a href="#cb121-709" aria-hidden="true" tabindex="-1"></a><span class="in">                 )</span></span>
<span id="cb121-710"><a href="#cb121-710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-711"><a href="#cb121-711" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-712"><a href="#cb121-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-713"><a href="#cb121-713" aria-hidden="true" tabindex="-1"></a>a. Plot the posterior predictive distributions from the two models. What is the difference in the posterior predictive distributions of the two models; and why is there a difference?</span>
<span id="cb121-714"><a href="#cb121-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-715"><a href="#cb121-715" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-716"><a href="#cb121-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-717"><a href="#cb121-717" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Posterior predictive distributions</span></span>
<span id="cb121-718"><a href="#cb121-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-721"><a href="#cb121-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-722"><a href="#cb121-722" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(</span>
<span id="cb121-723"><a href="#cb121-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pp_check</span>(fit_gw_norm, <span class="at">ndraws =</span> <span class="dv">1000</span>) <span class="sc">+</span></span>
<span id="cb121-724"><a href="#cb121-724" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Normal distr"</span>) <span class="sc">+</span></span>
<span id="cb121-725"><a href="#cb121-725" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>),</span>
<span id="cb121-726"><a href="#cb121-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pp_check</span>(fit_gw_log, <span class="at">ndraws =</span> <span class="dv">1000</span>) <span class="sc">+</span> </span>
<span id="cb121-727"><a href="#cb121-727" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Log-normal distr"</span>) <span class="sc">+</span></span>
<span id="cb121-728"><a href="#cb121-728" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>),</span>
<span id="cb121-729"><a href="#cb121-729" aria-hidden="true" tabindex="-1"></a>  cowplot<span class="sc">::</span><span class="fu">get_legend</span>(<span class="fu">pp_check</span>(fit_gw_log) <span class="sc">+</span></span>
<span id="cb121-730"><a href="#cb121-730" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)),</span>
<span id="cb121-731"><a href="#cb121-731" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb121-732"><a href="#cb121-732" aria-hidden="true" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(.<span class="dv">45</span>,.<span class="dv">45</span>,.<span class="dv">1</span>)</span>
<span id="cb121-733"><a href="#cb121-733" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-734"><a href="#cb121-734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-735"><a href="#cb121-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-736"><a href="#cb121-736" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>quite a mismatch in normal likelihood model, e.g., negative values are generated</span>
<span id="cb121-737"><a href="#cb121-737" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>log-normal better fit</span>
<span id="cb121-738"><a href="#cb121-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-739"><a href="#cb121-739" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-740"><a href="#cb121-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-741"><a href="#cb121-741" aria-hidden="true" tabindex="-1"></a>b. Examine the posterior distributions of the effect estimates (in milliseconds) in the two models. Why are these different?</span>
<span id="cb121-742"><a href="#cb121-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-743"><a href="#cb121-743" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-744"><a href="#cb121-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-745"><a href="#cb121-745" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Posterior distribution </span></span>
<span id="cb121-746"><a href="#cb121-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-749"><a href="#cb121-749" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-750"><a href="#cb121-750" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal distr</span></span>
<span id="cb121-751"><a href="#cb121-751" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_gw_norm)</span>
<span id="cb121-752"><a href="#cb121-752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-753"><a href="#cb121-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-756"><a href="#cb121-756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-757"><a href="#cb121-757" aria-hidden="true" tabindex="-1"></a><span class="co"># Log distr</span></span>
<span id="cb121-758"><a href="#cb121-758" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_gw_log)</span>
<span id="cb121-759"><a href="#cb121-759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-760"><a href="#cb121-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-761"><a href="#cb121-761" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Effect estimates</span></span>
<span id="cb121-762"><a href="#cb121-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-763"><a href="#cb121-763" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>look at effect estimates</span>
<span id="cb121-764"><a href="#cb121-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-767"><a href="#cb121-767" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-768"><a href="#cb121-768" aria-hidden="true" tabindex="-1"></a><span class="co"># normal distr</span></span>
<span id="cb121-769"><a href="#cb121-769" aria-hidden="true" tabindex="-1"></a>gw_intercept_norm <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw_norm)<span class="sc">$</span>b_Intercept</span>
<span id="cb121-770"><a href="#cb121-770" aria-hidden="true" tabindex="-1"></a>gw_slope_norm <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw_norm)<span class="sc">$</span>b_type1</span>
<span id="cb121-771"><a href="#cb121-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-772"><a href="#cb121-772" aria-hidden="true" tabindex="-1"></a>gw_RT_diff_norm <span class="ot">&lt;-</span> gw_slope_norm</span>
<span id="cb121-773"><a href="#cb121-773" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">quantile</span>(gw_RT_diff_norm,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),<span class="dv">2</span>)</span>
<span id="cb121-774"><a href="#cb121-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-775"><a href="#cb121-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-778"><a href="#cb121-778" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-779"><a href="#cb121-779" aria-hidden="true" tabindex="-1"></a><span class="co"># log distr</span></span>
<span id="cb121-780"><a href="#cb121-780" aria-hidden="true" tabindex="-1"></a>gw_intercept_log <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw_log)<span class="sc">$</span>b_Intercept</span>
<span id="cb121-781"><a href="#cb121-781" aria-hidden="true" tabindex="-1"></a>gw_slope_log <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw_log)<span class="sc">$</span>b_type1</span>
<span id="cb121-782"><a href="#cb121-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-783"><a href="#cb121-783" aria-hidden="true" tabindex="-1"></a>gw_RT_diff_log <span class="ot">&lt;-</span> <span class="fu">exp</span>(gw_intercept_log <span class="sc">+</span> gw_slope_log<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span></span>
<span id="cb121-784"><a href="#cb121-784" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(gw_intercept_log <span class="sc">-</span> gw_slope_log<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb121-785"><a href="#cb121-785" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(gw_RT_diff_log,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span>
<span id="cb121-786"><a href="#cb121-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-787"><a href="#cb121-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-790"><a href="#cb121-790" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-791"><a href="#cb121-791" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(rt<span class="sc">~</span>type,df_gibsonwu)</span>
<span id="cb121-792"><a href="#cb121-792" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-793"><a href="#cb121-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-794"><a href="#cb121-794" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>95% credible interval for estimates include 0 for both norm and log-norm distributions</span>
<span id="cb121-795"><a href="#cb121-795" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>log-norm model CrI is tighter, and includes smaller effect size (but includes 0)</span>
<span id="cb121-796"><a href="#cb121-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-797"><a href="#cb121-797" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-798"><a href="#cb121-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-799"><a href="#cb121-799" aria-hidden="true" tabindex="-1"></a>c. Given the posterior predictive distributions you plotted above, why is the log-normal likelihood model better for carrying out inference and hypothesis testing?</span>
<span id="cb121-800"><a href="#cb121-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-801"><a href="#cb121-801" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-802"><a href="#cb121-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-805"><a href="#cb121-805" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-806"><a href="#cb121-806" aria-hidden="true" tabindex="-1"></a><span class="co"># look at range per type</span></span>
<span id="cb121-807"><a href="#cb121-807" aria-hidden="true" tabindex="-1"></a>df_gibsonwu <span class="sc">%&gt;%</span></span>
<span id="cb121-808"><a href="#cb121-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb121-809"><a href="#cb121-809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">min</span>(rt), <span class="fu">max</span>(rt))</span>
<span id="cb121-810"><a href="#cb121-810" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-811"><a href="#cb121-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-814"><a href="#cb121-814" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-815"><a href="#cb121-815" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrain) </span>
<span id="cb121-816"><a href="#cb121-816" aria-hidden="true" tabindex="-1"></a>df_gibsonwu <span class="sc">%&gt;%</span></span>
<span id="cb121-817"><a href="#cb121-817" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(session!="bi") %&gt;%</span></span>
<span id="cb121-818"><a href="#cb121-818" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(px_list = paste0(participant,list)) %&gt;%</span></span>
<span id="cb121-819"><a href="#cb121-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., </span>
<span id="cb121-820"><a href="#cb121-820" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> rt, </span>
<span id="cb121-821"><a href="#cb121-821" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> type, <span class="at">color =</span> type, <span class="at">shape =</span> type)) <span class="sc">+</span></span>
<span id="cb121-822"><a href="#cb121-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of observations"</span>) <span class="sc">+</span></span>
<span id="cb121-823"><a href="#cb121-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rain</span>(<span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">rain.side =</span> <span class="st">'f1x1'</span>,</span>
<span id="cb121-824"><a href="#cb121-824" aria-hidden="true" tabindex="-1"></a>            <span class="at">violin.args =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb121-825"><a href="#cb121-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb121-826"><a href="#cb121-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"dodgerblue"</span>, <span class="st">"darkorange"</span>)) <span class="sc">+</span></span>
<span id="cb121-827"><a href="#cb121-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"dodgerblue"</span>, <span class="st">"darkorange"</span>)) </span>
<span id="cb121-828"><a href="#cb121-828" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-829"><a href="#cb121-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-830"><a href="#cb121-830" aria-hidden="true" tabindex="-1"></a><span class="fu">#### My answer</span></span>
<span id="cb121-831"><a href="#cb121-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-832"><a href="#cb121-832" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>subj-ext had extreme raw values; this would've biased the model with a normal distribution</span>
<span id="cb121-833"><a href="#cb121-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-834"><a href="#cb121-834" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-835"><a href="#cb121-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-836"><a href="#cb121-836" aria-hidden="true" tabindex="-1"></a>Next, work out a normal approximation of the log-normal model’s posterior distribution for the relative clause effect that you obtained from the above data analysis. Then use that normal approximation as an informative prior for the slope parameter when fitting a hierarchical model to the second data set. This is an example of incrementally building up knowledge by successively using a previous study’s posterior as a prior for the next study; this is essentially equivalent to pooling both data sets (check that pooling the data and using a Normal(0,1) prior for the effect of interest, with a log-normal likelihood, gives you approximately the same posterior as the informative-prior model fit above).</span>
<span id="cb121-837"><a href="#cb121-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-838"><a href="#cb121-838" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-839"><a href="#cb121-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-840"><a href="#cb121-840" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Dataset 1 log estimates</span></span>
<span id="cb121-841"><a href="#cb121-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-842"><a href="#cb121-842" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>first check 2nd dataset</span>
<span id="cb121-843"><a href="#cb121-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-846"><a href="#cb121-846" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-847"><a href="#cb121-847" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_gibsonwu2)</span>
<span id="cb121-848"><a href="#cb121-848" aria-hidden="true" tabindex="-1"></a>df_gibsonwu2 <span class="ot">&lt;-</span> df_gibsonwu2 <span class="sc">%&gt;%</span></span>
<span id="cb121-849"><a href="#cb121-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"type"</span> <span class="ot">=</span> condition)</span>
<span id="cb121-850"><a href="#cb121-850" aria-hidden="true" tabindex="-1"></a>df_gibsonwu2<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_gibsonwu2<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"obj-ext"</span>,<span class="st">"subj-ext"</span>))</span>
<span id="cb121-851"><a href="#cb121-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-852"><a href="#cb121-852" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gibsonwu2<span class="sc">$</span>type) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb121-853"><a href="#cb121-853" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gibsonwu2<span class="sc">$</span>type)</span>
<span id="cb121-854"><a href="#cb121-854" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-855"><a href="#cb121-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-856"><a href="#cb121-856" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>remind ourselves of the estimates from the first dataset</span>
<span id="cb121-857"><a href="#cb121-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-860"><a href="#cb121-860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-861"><a href="#cb121-861" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_gw_log)</span>
<span id="cb121-862"><a href="#cb121-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-863"><a href="#cb121-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-864"><a href="#cb121-864" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>for replication study, use:</span>
<span id="cb121-865"><a href="#cb121-865" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>type: $LogNormal(-0.07, 0.07)$ (<span class="in">`type1`</span> Estimate and Est. Error?)</span>
<span id="cb121-866"><a href="#cb121-866" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>Intercept: $LogNormal(6, 0.06)$</span>
<span id="cb121-867"><a href="#cb121-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-868"><a href="#cb121-868" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Dataset 2 model</span></span>
<span id="cb121-869"><a href="#cb121-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-872"><a href="#cb121-872" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-873"><a href="#cb121-873" aria-hidden="true" tabindex="-1"></a>priors_gw2_log <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb121-874"><a href="#cb121-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(6, 0.07)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb121-875"><a href="#cb121-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(-0.7,0.06)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"type1"</span>),</span>
<span id="cb121-876"><a href="#cb121-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sd"</span>),</span>
<span id="cb121-877"><a href="#cb121-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb121-878"><a href="#cb121-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"lkj(2)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>)</span>
<span id="cb121-879"><a href="#cb121-879" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-880"><a href="#cb121-880" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-881"><a href="#cb121-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-882"><a href="#cb121-882" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>fit model; convergence warning (ESS too low)</span>
<span id="cb121-883"><a href="#cb121-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-884"><a href="#cb121-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = F, error=TRUE, warning=TRUE}</span></span>
<span id="cb121-885"><a href="#cb121-885" aria-hidden="true" tabindex="-1"></a><span class="in">fit_gw2_log &lt;- brm(rt ~ 1 + type + </span></span>
<span id="cb121-886"><a href="#cb121-886" aria-hidden="true" tabindex="-1"></a><span class="in">                   (1 + type | subj) +</span></span>
<span id="cb121-887"><a href="#cb121-887" aria-hidden="true" tabindex="-1"></a><span class="in">                   (1 + type | item), </span></span>
<span id="cb121-888"><a href="#cb121-888" aria-hidden="true" tabindex="-1"></a><span class="in">                 data = df_gibsonwu2,</span></span>
<span id="cb121-889"><a href="#cb121-889" aria-hidden="true" tabindex="-1"></a><span class="in">                 family = lognormal(),</span></span>
<span id="cb121-890"><a href="#cb121-890" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior = priors_gw2_log,</span></span>
<span id="cb121-891"><a href="#cb121-891" aria-hidden="true" tabindex="-1"></a><span class="in">                 file = here::here("models", "exercises", "ch5", "fit_gw2_log")</span></span>
<span id="cb121-892"><a href="#cb121-892" aria-hidden="true" tabindex="-1"></a><span class="in">                 )</span></span>
<span id="cb121-893"><a href="#cb121-893" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-894"><a href="#cb121-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-897"><a href="#cb121-897" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-898"><a href="#cb121-898" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_gw2_log)</span>
<span id="cb121-899"><a href="#cb121-899" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-900"><a href="#cb121-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-903"><a href="#cb121-903" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-904"><a href="#cb121-904" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_gw2_log)</span>
<span id="cb121-905"><a href="#cb121-905" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-906"><a href="#cb121-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-907"><a href="#cb121-907" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Estimates</span></span>
<span id="cb121-908"><a href="#cb121-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-911"><a href="#cb121-911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-912"><a href="#cb121-912" aria-hidden="true" tabindex="-1"></a><span class="co"># log distr</span></span>
<span id="cb121-913"><a href="#cb121-913" aria-hidden="true" tabindex="-1"></a>gw2_intercept_log <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw2_log)<span class="sc">$</span>b_Intercept</span>
<span id="cb121-914"><a href="#cb121-914" aria-hidden="true" tabindex="-1"></a>gw2_slope_log <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw2_log)<span class="sc">$</span>b_type1</span>
<span id="cb121-915"><a href="#cb121-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-916"><a href="#cb121-916" aria-hidden="true" tabindex="-1"></a>gw2_RT_diff_log <span class="ot">&lt;-</span> <span class="fu">exp</span>(gw2_intercept_log <span class="sc">+</span> gw2_slope_log<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">exp</span>(gw2_intercept_log <span class="sc">-</span> gw2_slope_log<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb121-917"><a href="#cb121-917" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(gw2_RT_diff_log,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span>
<span id="cb121-918"><a href="#cb121-918" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-919"><a href="#cb121-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-920"><a href="#cb121-920" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-921"><a href="#cb121-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-922"><a href="#cb121-922" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip}</span>
<span id="cb121-923"><a href="#cb121-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-924"><a href="#cb121-924" aria-hidden="true" tabindex="-1"></a><span class="fu">### Datasets 1 and 2</span></span>
<span id="cb121-925"><a href="#cb121-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-928"><a href="#cb121-928" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-929"><a href="#cb121-929" aria-hidden="true" tabindex="-1"></a><span class="co"># make sure 2 datasets have same column names/order</span></span>
<span id="cb121-930"><a href="#cb121-930" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df_gibsonwu); <span class="fu">names</span>(df_gibsonwu2)</span>
<span id="cb121-931"><a href="#cb121-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-932"><a href="#cb121-932" aria-hidden="true" tabindex="-1"></a>df_gibsonwu2 <span class="ot">&lt;-</span> df_gibsonwu2 <span class="sc">%&gt;%</span></span>
<span id="cb121-933"><a href="#cb121-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subj,item,type,rt) <span class="sc">%&gt;%</span></span>
<span id="cb121-934"><a href="#cb121-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subj =</span> <span class="fu">paste0</span>(subj,<span class="st">"_gw2"</span>),</span>
<span id="cb121-935"><a href="#cb121-935" aria-hidden="true" tabindex="-1"></a>         <span class="at">item =</span> <span class="fu">paste0</span>(item,<span class="st">"_gw2"</span>))</span>
<span id="cb121-936"><a href="#cb121-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-937"><a href="#cb121-937" aria-hidden="true" tabindex="-1"></a>df_gibsonwu <span class="ot">&lt;-</span> df_gibsonwu <span class="sc">%&gt;%</span></span>
<span id="cb121-938"><a href="#cb121-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subj =</span> <span class="fu">paste0</span>(subj,<span class="st">"_gw1"</span>),</span>
<span id="cb121-939"><a href="#cb121-939" aria-hidden="true" tabindex="-1"></a>         <span class="at">item =</span> <span class="fu">paste0</span>(item,<span class="st">"_gw1"</span>))</span>
<span id="cb121-940"><a href="#cb121-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-941"><a href="#cb121-941" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df_gibsonwu) <span class="sc">==</span> <span class="fu">names</span>(df_gibsonwu2)</span>
<span id="cb121-942"><a href="#cb121-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-943"><a href="#cb121-943" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb121-944"><a href="#cb121-944" aria-hidden="true" tabindex="-1"></a>df_gw12 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_gibsonwu,df_gibsonwu2)</span>
<span id="cb121-945"><a href="#cb121-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-946"><a href="#cb121-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-947"><a href="#cb121-947" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Informative model</span></span>
<span id="cb121-948"><a href="#cb121-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-951"><a href="#cb121-951" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-952"><a href="#cb121-952" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts</span></span>
<span id="cb121-953"><a href="#cb121-953" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_gw12)</span>
<span id="cb121-954"><a href="#cb121-954" aria-hidden="true" tabindex="-1"></a>df_gw12<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_gw12<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"obj-ext"</span>,<span class="st">"subj-ext"</span>))</span>
<span id="cb121-955"><a href="#cb121-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-956"><a href="#cb121-956" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gw12<span class="sc">$</span>type) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb121-957"><a href="#cb121-957" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df_gw12<span class="sc">$</span>type)</span>
<span id="cb121-958"><a href="#cb121-958" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-959"><a href="#cb121-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-960"><a href="#cb121-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-961"><a href="#cb121-961" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>same priors as based on previous models</span>
<span id="cb121-962"><a href="#cb121-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-965"><a href="#cb121-965" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-966"><a href="#cb121-966" aria-hidden="true" tabindex="-1"></a>priors_gw12_log <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb121-967"><a href="#cb121-967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(6, 0.07)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb121-968"><a href="#cb121-968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(-0.7,0.06)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"type1"</span>),</span>
<span id="cb121-969"><a href="#cb121-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sd"</span>),</span>
<span id="cb121-970"><a href="#cb121-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb121-971"><a href="#cb121-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"lkj(2)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>)</span>
<span id="cb121-972"><a href="#cb121-972" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-973"><a href="#cb121-973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-974"><a href="#cb121-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-975"><a href="#cb121-975" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = F, error=TRUE, warning=TRUE}</span></span>
<span id="cb121-976"><a href="#cb121-976" aria-hidden="true" tabindex="-1"></a><span class="in">fit_gw12_log &lt;- brm(rt ~ 1 + type + </span></span>
<span id="cb121-977"><a href="#cb121-977" aria-hidden="true" tabindex="-1"></a><span class="in">                   (1 + type | subj) +</span></span>
<span id="cb121-978"><a href="#cb121-978" aria-hidden="true" tabindex="-1"></a><span class="in">                   (1 + type | item), </span></span>
<span id="cb121-979"><a href="#cb121-979" aria-hidden="true" tabindex="-1"></a><span class="in">                 data = df_gw12,</span></span>
<span id="cb121-980"><a href="#cb121-980" aria-hidden="true" tabindex="-1"></a><span class="in">                 family = lognormal(),</span></span>
<span id="cb121-981"><a href="#cb121-981" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior = priors_gw12_log,</span></span>
<span id="cb121-982"><a href="#cb121-982" aria-hidden="true" tabindex="-1"></a><span class="in">                 file = here::here("models", "exercises", "ch5", "fit_gw12_log")</span></span>
<span id="cb121-983"><a href="#cb121-983" aria-hidden="true" tabindex="-1"></a><span class="in">                 )</span></span>
<span id="cb121-984"><a href="#cb121-984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-985"><a href="#cb121-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-988"><a href="#cb121-988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-989"><a href="#cb121-989" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_gw12_log)</span>
<span id="cb121-990"><a href="#cb121-990" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-991"><a href="#cb121-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-994"><a href="#cb121-994" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-995"><a href="#cb121-995" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_gw12_log)</span>
<span id="cb121-996"><a href="#cb121-996" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-997"><a href="#cb121-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-998"><a href="#cb121-998" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Estimates</span></span>
<span id="cb121-999"><a href="#cb121-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1002"><a href="#cb121-1002" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-1003"><a href="#cb121-1003" aria-hidden="true" tabindex="-1"></a><span class="co"># log distr</span></span>
<span id="cb121-1004"><a href="#cb121-1004" aria-hidden="true" tabindex="-1"></a>gw12_intercept_log <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw12_log)<span class="sc">$</span>b_Intercept</span>
<span id="cb121-1005"><a href="#cb121-1005" aria-hidden="true" tabindex="-1"></a>gw12_slope_log <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw12_log)<span class="sc">$</span>b_type1</span>
<span id="cb121-1006"><a href="#cb121-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1007"><a href="#cb121-1007" aria-hidden="true" tabindex="-1"></a>gw12_RT_diff_log <span class="ot">&lt;-</span> <span class="fu">exp</span>(gw12_intercept_log <span class="sc">+</span> gw12_slope_log<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">exp</span>(gw12_intercept_log <span class="sc">-</span> gw12_slope_log<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb121-1008"><a href="#cb121-1008" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(gw12_RT_diff_log,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span>
<span id="cb121-1009"><a href="#cb121-1009" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-1010"><a href="#cb121-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1011"><a href="#cb121-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>negative slope, CrI doesn't include 0</span>
<span id="cb121-1012"><a href="#cb121-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1013"><a href="#cb121-1013" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Regularised prior?</span></span>
<span id="cb121-1014"><a href="#cb121-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1017"><a href="#cb121-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-1018"><a href="#cb121-1018" aria-hidden="true" tabindex="-1"></a>priors_gw12_log_reg <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb121-1019"><a href="#cb121-1019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(6, 1.5)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb121-1020"><a href="#cb121-1020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"type1"</span>),</span>
<span id="cb121-1021"><a href="#cb121-1021" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sd"</span>),</span>
<span id="cb121-1022"><a href="#cb121-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"normal(0,1)"</span>,<span class="at">class =</span> <span class="st">"sigma"</span>),</span>
<span id="cb121-1023"><a href="#cb121-1023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_prior</span>(<span class="st">"lkj(2)"</span>, <span class="at">class =</span> <span class="st">"cor"</span>)</span>
<span id="cb121-1024"><a href="#cb121-1024" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-1025"><a href="#cb121-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-1026"><a href="#cb121-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1027"><a href="#cb121-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = F, error=TRUE, warning=TRUE}</span></span>
<span id="cb121-1028"><a href="#cb121-1028" aria-hidden="true" tabindex="-1"></a><span class="in">fit_gw12_log_reg &lt;- brm(rt ~ 1 + type + </span></span>
<span id="cb121-1029"><a href="#cb121-1029" aria-hidden="true" tabindex="-1"></a><span class="in">                   (1 + type | subj) +</span></span>
<span id="cb121-1030"><a href="#cb121-1030" aria-hidden="true" tabindex="-1"></a><span class="in">                   (1 + type | item), </span></span>
<span id="cb121-1031"><a href="#cb121-1031" aria-hidden="true" tabindex="-1"></a><span class="in">                 data = df_gw12,</span></span>
<span id="cb121-1032"><a href="#cb121-1032" aria-hidden="true" tabindex="-1"></a><span class="in">                 family = lognormal(),</span></span>
<span id="cb121-1033"><a href="#cb121-1033" aria-hidden="true" tabindex="-1"></a><span class="in">                 prior = priors_gw12_log_reg,</span></span>
<span id="cb121-1034"><a href="#cb121-1034" aria-hidden="true" tabindex="-1"></a><span class="in">                 file = here::here("models", "exercises", "ch5", "fit_gw12_log_reg")</span></span>
<span id="cb121-1035"><a href="#cb121-1035" aria-hidden="true" tabindex="-1"></a><span class="in">                 )</span></span>
<span id="cb121-1036"><a href="#cb121-1036" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-1037"><a href="#cb121-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1040"><a href="#cb121-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-1041"><a href="#cb121-1041" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_gw12_log_reg)</span>
<span id="cb121-1042"><a href="#cb121-1042" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(fit_gw12_log_reg)</span>
<span id="cb121-1043"><a href="#cb121-1043" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-1044"><a href="#cb121-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1047"><a href="#cb121-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-1048"><a href="#cb121-1048" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_gw12_log_reg)</span>
<span id="cb121-1049"><a href="#cb121-1049" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-1050"><a href="#cb121-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1051"><a href="#cb121-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Estimates</span></span>
<span id="cb121-1052"><a href="#cb121-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1055"><a href="#cb121-1055" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-1056"><a href="#cb121-1056" aria-hidden="true" tabindex="-1"></a><span class="co"># log distr</span></span>
<span id="cb121-1057"><a href="#cb121-1057" aria-hidden="true" tabindex="-1"></a>gw12_intercept_log_reg <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw12_log_reg)<span class="sc">$</span>b_Intercept</span>
<span id="cb121-1058"><a href="#cb121-1058" aria-hidden="true" tabindex="-1"></a>gw12_slope_log_reg <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_gw12_log_reg)<span class="sc">$</span>b_type1</span>
<span id="cb121-1059"><a href="#cb121-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1060"><a href="#cb121-1060" aria-hidden="true" tabindex="-1"></a>gw12_RT_diff_log_reg <span class="ot">&lt;-</span> <span class="fu">exp</span>(gw12_intercept_log_reg <span class="sc">+</span> gw12_slope_log_reg<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> </span>
<span id="cb121-1061"><a href="#cb121-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(gw12_intercept_log_reg <span class="sc">-</span> gw12_slope_log_reg<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb121-1062"><a href="#cb121-1062" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(gw12_RT_diff_log_reg,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span>
<span id="cb121-1063"><a href="#cb121-1063" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-1064"><a href="#cb121-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1065"><a href="#cb121-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>now the 95% CrI does not include 0, but the range of values is much tighter and includes smaller values</span>
<span id="cb121-1066"><a href="#cb121-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1067"><a href="#cb121-1067" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb121-1068"><a href="#cb121-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1069"><a href="#cb121-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 5.4 - Agreement attraction in comprehension</span></span>
<span id="cb121-1070"><a href="#cb121-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1071"><a href="#cb121-1071" aria-hidden="true" tabindex="-1"></a>Load the following data:</span>
<span id="cb121-1072"><a href="#cb121-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1075"><a href="#cb121-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-1076"><a href="#cb121-1076" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"df_dillonE1"</span>)</span>
<span id="cb121-1077"><a href="#cb121-1077" aria-hidden="true" tabindex="-1"></a>dillonE1 <span class="ot">&lt;-</span> df_dillonE1</span>
<span id="cb121-1078"><a href="#cb121-1078" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dillonE1)</span>
<span id="cb121-1079"><a href="#cb121-1079" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-1080"><a href="#cb121-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1081"><a href="#cb121-1081" aria-hidden="true" tabindex="-1"></a>The data are taken from an experiment that investigate (inter alia) the effect of number similarity between a noun and the auxiliary verb in sentences like the following. There are two levels to a factor called Int(erference): low and high.</span>
<span id="cb121-1082"><a href="#cb121-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1083"><a href="#cb121-1083" aria-hidden="true" tabindex="-1"></a>(3a) *low*: The key to the cabinet are on the table </span>
<span id="cb121-1084"><a href="#cb121-1084" aria-hidden="true" tabindex="-1"></a>(3b) *high*: The key to the cabinets are on the table</span>
<span id="cb121-1085"><a href="#cb121-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1086"><a href="#cb121-1086" aria-hidden="true" tabindex="-1"></a>Here, in (3b), the auxiliary verb are is predicted to be read faster than in (3a), because the plural marking on the noun cabinets leads the reader to think that the sentence is grammatical. (Both sentences are ungrammatical.) This phenomenon, where the high condition is read faster than the low condition, is called **agreement attraction**.</span>
<span id="cb121-1087"><a href="#cb121-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1088"><a href="#cb121-1088" aria-hidden="true" tabindex="-1"></a>The data provided are for the critical region (the auxiliary verb are). The experiment method is eye-tracking; we have total reading times in milliseconds.</span>
<span id="cb121-1089"><a href="#cb121-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1090"><a href="#cb121-1090" aria-hidden="true" tabindex="-1"></a>The research question is whether the difference in reading times between high and low conditions is negative.</span>
<span id="cb121-1091"><a href="#cb121-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1092"><a href="#cb121-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>First, using a log-normal likelihood, fit a hierarchical model with correlated varying intercept and slopes for subjects and items. You will need to decide on the priors for the model.</span>
<span id="cb121-1093"><a href="#cb121-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>By simply looking at the posterior distribution of the slope parameter, $\beta$, what would you conclude about the theoretical claim relating to agreement attraction?</span>
<span id="cb121-1094"><a href="#cb121-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1095"><a href="#cb121-1095" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 5.5</span></span>
<span id="cb121-1096"><a href="#cb121-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1097"><a href="#cb121-1097" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 5.6</span></span>
<span id="cb121-1098"><a href="#cb121-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1099"><a href="#cb121-1099" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 5.7</span></span>
<span id="cb121-1100"><a href="#cb121-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1101"><a href="#cb121-1101" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 5.8</span></span>
<span id="cb121-1102"><a href="#cb121-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1103"><a href="#cb121-1103" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session Info</span></span>
<span id="cb121-1104"><a href="#cb121-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1105"><a href="#cb121-1105" aria-hidden="true" tabindex="-1"></a>Compiled with <span class="in">`r R.version$version`</span> (<span class="in">`r R.version$nickname`</span>) in RStudio version 2023.12.1.402 (Ocean Storm).</span>
<span id="cb121-1106"><a href="#cb121-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1109"><a href="#cb121-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-1110"><a href="#cb121-1110" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb121-1111"><a href="#cb121-1111" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb121-1112"><a href="#cb121-1112" aria-hidden="true" tabindex="-1"></a><span class="fu">RStudio.Version</span>()<span class="sc">$</span>version; <span class="fu">RStudio.Version</span>()<span class="sc">$</span>release_name</span>
<span id="cb121-1113"><a href="#cb121-1113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-1114"><a href="#cb121-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1117"><a href="#cb121-1117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb121-1118"><a href="#cb121-1118" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb121-1119"><a href="#cb121-1119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb121-1120"><a href="#cb121-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1121"><a href="#cb121-1121" aria-hidden="true" tabindex="-1"></a><span class="fu"># References {.unnumbered}</span></span>
<span id="cb121-1122"><a href="#cb121-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-1123"><a href="#cb121-1123" aria-hidden="true" tabindex="-1"></a>::: {#refs custom-style="Bibliography"}</span>
<span id="cb121-1124"><a href="#cb121-1124" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>